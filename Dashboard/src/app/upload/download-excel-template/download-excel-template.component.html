<!-- <p class="tagname">Download Excel Template</p>
<mat-divider style="margin: 20px; color: aqua; background-color: #33BABC;" ></mat-divider>

<div class="container">

        <mat-card-content>
            <div class="grid-content">
                <div class="form-group">
                    <mat-label>I want to</mat-label>
                    <mat-select [(ngModel)]="action" [value]="action" (selectionChange)="uploadDownloadChanged($event)">
                        <mat-option value="DOWNLOAD-TEMPLATE">Download Template</mat-option>
                        <mat-option value="UPLOAD-DATA">Upload Data</mat-option>
                    </mat-select>
                </div>
        
                <div class="form-group" *ngIf="action=='UPLOAD-DATA'">
                    <mat-label>Excel Upload Ref. No.</mat-label>
                    <mat-select [(ngModel)]="selectedExcelUploadReferenceNumber" [value]="selectedExcelUploadReferenceNumber"
                        (selectionChange)="getExcelUploadInfo($event)">
                        <mat-option *ngFor="let excelUpload of excelUploads"
                            [value]="excelUpload.referenceNumber">{{excelUpload.referenceNumber}}
                        </mat-option>
                    </mat-select>
                </div>
            </div>
    
            <form [formGroup]="downloadExcelTemplateForm">
                    <div class="grid-content">
                    <div class="form-group">
                        <mat-label>Client</mat-label>
                        <mat-select formControlName="clientId" (selectionChange)="clientSelectionChanged($event)">
                            <mat-option *ngFor="let client of clients" [value]="client._id">
                                {{client.name}}
                            </mat-option>
                        </mat-select>
                    </div>
                    <div class="form-group">
                        <mat-label>Subclient</mat-label>
                        <mat-select formControlName="subclientId">
                            <mat-option *ngFor="let subclient of subclients" [value]="subclient._id">{{subclient.name}}
                            </mat-option>
                        </mat-select>
                    </div>
                    <div class="form-group">
                        <mat-label>Package / Profile / A la carte</mat-label>
                        <mat-select formControlName="packageProfileAlacarte"
                            (selectionChange)="packageProfileAlacarteChanged($event)">
                            <mat-option value="PACKAGE">Package</mat-option>
                            <mat-option value="PROFILE">Profile</mat-option>
                            <mat-option value="A-LA-CARTE">A a carte</mat-option>
                        </mat-select>
                    </div>
                    <div class="form-group" *ngIf="downloadExcelTemplateForm.get('packageProfileAlacarte')!.value=='PACKAGE'">
                        <mat-label>Select a Package</mat-label>
                        <mat-select formControlName="package" (selectionChange)="packageChanged($event)">
                            <mat-option *ngFor="let package of packages" [value]="package._id">{{package.name}}</mat-option>
                        </mat-select>
                    </div>
                    <div class="form-group" *ngIf="downloadExcelTemplateForm.get('packageProfileAlacarte')!.value=='PROFILE'">
                        <mat-label>Select a Profile</mat-label>
                        <mat-select formControlName="profile" (selectionChange)="profileChanged($event)">
                            <mat-option *ngFor="let profile of profiles" [value]="profile._id">{{profile.name}}</mat-option>
                        </mat-select>
                    </div>
                </div>
                </form>
            <div>
                <div *ngIf="downloadExcelTemplateForm.get('packageProfileAlacarte')!.value=='PACKAGE'">
                    <div class="table-container">
                        <div class="table">
                            <div class="header">
                                <table mat-table [dataSource]="packageComponentsDataSource" matSort>
                                    <ng-container matColumnDef="serialNumber">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
                                        <td mat-cell *matCellDef="let row; let i = index" (click)="showDetails(row)">
                                            {{ i + 1 }}
                                        </td>
                                    </ng-container>
    
                                    <ng-container matColumnDef="component">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header> Component Name</th>
                                        <td mat-cell *matCellDef="let row"> {{row.componentName}} </td>
                                    </ng-container>
    
                                    <ng-container matColumnDef="details">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header> Details</th>
                                        <td mat-cell *matCellDef="let row"> {{row.details}} </td>
                                    </ng-container>
    
                                    <tr mat-header-row *matHeaderRowDef="packageComponentsDisplayedColumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: packageComponentsDisplayedColumns;"></tr>
    
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="downloadExcelTemplateForm.get('packageProfileAlacarte')!.value=='PROFILE'" fxFlex="100%"
                    fxLayoutAlign="center" fxLayout="row">
                    <div class="table-container">
                        <div class="table">
                            <div class="header">
                                <div >
                                    <table mat-table [dataSource]="profileComponentsDataSource" matSort>
    
                                        <ng-container matColumnDef="serialNumber">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
                                            <td mat-cell *matCellDef="let row; let i = index" (click)="showDetails(row)">
                                                {{ i + 1 }}
                                            </td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="component">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Component Name</th>
                                            <td mat-cell *matCellDef="let row"> {{row.componentName}} </td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="details">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Details</th>
                                            <td mat-cell *matCellDef="let row"> {{row.details}} </td>
                                        </ng-container>
    
                                        <tr mat-header-row *matHeaderRowDef="profileComponentsDisplayedColumns"></tr>
                                        <tr mat-row *matRowDef="let row; columns: profileComponentsDisplayedColumns"></tr>
    
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="downloadExcelTemplateForm.get('packageProfileAlacarte')!.value=='A-LA-CARTE'">
                    <div class="table-container">
                        <div class="table">
                            <div class="header">
                                <div>
                                    <table mat-table [dataSource]="componentsDataSource" matSort>
                                        <ng-container matColumnDef="serialNumber">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
                                            <td mat-cell *matCellDef="let row; let i = index" (click)="showDetails(row)">
                                                {{ i + 1 }}
                                            </td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="component">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Component Name</th>
                                            <td mat-cell *matCellDef="let row"> {{row.componentName}} </td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="tat">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> TAT</th>
                                            <td mat-cell *matCellDef="let row"> {{row.tat}} </td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="rate">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Rate per check</th>
                                            <td mat-cell *matCellDef="let row"> {{row.rate}} </td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="details">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Details</th>
                                            <td mat-cell *matCellDef="let row"> <input [(ngModel)]="row.instructions"
                                                    value="row.instructions" type="text" maxlength="200"></td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="maxChecks">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Max Checks</th>
                                            <td mat-cell *matCellDef="let row"><input [(ngModel)]="row.maxChecks"
                                                    value="row.maxChecks" type="text" size="3" maxlength="3"></td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="select">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Select</th>
                                            <td mat-cell *matCellDef="let row"> <mat-checkbox
                                                    [disabled]="row.instructions==null || row.instructions=='' || row.maxChecks==null || row.maxChecks <=0"
                                                    [checked]="row.selected" [(ngModel)]="row.selected"></mat-checkbox>
                                            </td>
                                        </ng-container>
    
                                        <tr mat-header-row *matHeaderRowDef="componentsDisplayedColumns"></tr>
                                        <tr mat-row *matRowDef="let row; columns: componentsDisplayedColumns"></tr>
    
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </mat-card-content>
        <mat-card-footer class="footer">
            <div *ngIf="action=='DOWNLOAD-TEMPLATE'">
                <button matTooltip="Download Excel Template" mat-raised-button (click)="downloadExcelTemplate()"
                    color="primary">Download Excel Template<mat-icon>file_download</mat-icon></button>
            </div>
        
            <div *ngIf="action === 'UPLOAD-DATA'" class="form-footer" style="padding: 0px;">
                <label>Click here to select a file</label>
                <mat-form-field appearance="outline">
                    <ngx-mat-file-input (change)="fileChanged($event)" accept=".xlsx"></ngx-mat-file-input>
                </mat-form-field>
                <button class="btn-rounded" (click)="uploadButtonClicked()">
                    Upload Excel <mat-icon>file_upload</mat-icon>
                </button>
            </div>
        </mat-card-footer>
    
</div> -->


<!-- /////New code  -->
 <!-- ////download-excel-template.component.html/// -->

<p class="tagname">Download Excel Template</p>
<mat-divider style="margin: 20px; color: aqua; background-color: #33BABC;" ></mat-divider>

<div class="container">

        <mat-card-content>
            <div class="grid-content">
                <div class="form-group">
                    <mat-label>I want to</mat-label>
                    <mat-select [(ngModel)]="action" [value]="action" (selectionChange)="uploadDownloadChanged($event)">
                        <mat-option value="DOWNLOAD-TEMPLATE">Download Template</mat-option>
                        <mat-option value="UPLOAD-DATA">Upload Data</mat-option>
                    </mat-select>
                </div>
        
                <div class="form-group" *ngIf="action=='UPLOAD-DATA'">
                    <mat-label>Excel Upload Ref. No.</mat-label>
                    <mat-select [(ngModel)]="selectedExcelUploadReferenceNumber" [value]="selectedExcelUploadReferenceNumber"
                        (selectionChange)="getExcelUploadInfo($event)">
                        <mat-option *ngFor="let excelUpload of excelUploads"
                            [value]="excelUpload.referenceNumber">{{excelUpload.referenceNumber}}
                        </mat-option>
                    </mat-select>
                </div>
            </div>
    
            <form [formGroup]="downloadExcelTemplateForm">
                    <div class="grid-content">
                    <div class="form-group">
                        <mat-label>Client</mat-label>
                        <mat-select formControlName="clientId" (selectionChange)="clientSelectionChanged($event)">
                            <mat-option *ngFor="let client of clients" [value]="client._id">
                                {{client.name}}
                            </mat-option>
                        </mat-select>
                    </div>
                    <div class="form-group">
                        <mat-label>Subclient</mat-label>
                        <mat-select formControlName="subclientId">
                            <mat-option *ngFor="let subclient of subclients" [value]="subclient._id">{{subclient.name}}
                            </mat-option>
                        </mat-select>
                    </div>
                    <div class="form-group">
                        <mat-label>Package / Profile / A la carte</mat-label>
                        <mat-select formControlName="packageProfileAlacarte"
                            (selectionChange)="packageProfileAlacarteChanged($event)">
                            <mat-option value="PACKAGE">Package</mat-option>
                            <mat-option value="PROFILE">Profile</mat-option>
                            <mat-option value="A-LA-CARTE">A a carte</mat-option>
                        </mat-select>
                    </div>
                    <div class="form-group" *ngIf="downloadExcelTemplateForm.get('packageProfileAlacarte')!.value=='PACKAGE'">
                        <mat-label>Select a Package</mat-label>
                        <mat-select formControlName="package" (selectionChange)="packageChanged($event)">
                            <mat-option *ngFor="let package of packages" [value]="package._id">{{package.name}}</mat-option>
                        </mat-select>
                    </div>
                    <div class="form-group" *ngIf="downloadExcelTemplateForm.get('packageProfileAlacarte')!.value=='PROFILE'">
                        <mat-label>Select a Profile</mat-label>
                        <mat-select formControlName="profile" (selectionChange)="profileChanged($event)">
                            <mat-option *ngFor="let profile of profiles" [value]="profile._id">{{profile.name}}</mat-option>
                        </mat-select>
                    </div>
                </div>
                </form>
            <div>
                <div *ngIf="downloadExcelTemplateForm.get('packageProfileAlacarte')!.value=='PACKAGE'">
                    <div class="table-container">
                        <div class="table">
                            <div class="header">
                                <table mat-table [dataSource]="packageComponentsDataSource" matSort>
                                    <ng-container matColumnDef="serialNumber">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
                                        <td mat-cell *matCellDef="let row; let i = index" (click)="showDetails(row)">
                                            {{ i + 1 }}
                                        </td>
                                    </ng-container>
    
                                    <ng-container matColumnDef="component">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header> Component Name</th>
                                        <td mat-cell *matCellDef="let row"> {{row.componentName}} </td>
                                    </ng-container>
    
                                    <ng-container matColumnDef="details">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header> Details</th>
                                        <td mat-cell *matCellDef="let row"> {{row.details}} </td>
                                    </ng-container>
    
                                    <tr mat-header-row *matHeaderRowDef="packageComponentsDisplayedColumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: packageComponentsDisplayedColumns;"></tr>
    
                                </table>
                                <!-- <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator> -->
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="downloadExcelTemplateForm.get('packageProfileAlacarte')!.value=='PROFILE'" fxFlex="100%"
                    fxLayoutAlign="center" fxLayout="row">
                    <div class="table-container">
                        <div class="table">
                            <div class="header">
                                <div >
                                    <table mat-table [dataSource]="profileComponentsDataSource" matSort>
    
                                        <ng-container matColumnDef="serialNumber">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
                                            <td mat-cell *matCellDef="let row; let i = index" (click)="showDetails(row)">
                                                {{ i + 1 }}
                                            </td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="component">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Component Name</th>
                                            <td mat-cell *matCellDef="let row"> {{row.componentName}} </td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="details">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Details</th>
                                            <td mat-cell *matCellDef="let row"> {{row.details}} </td>
                                        </ng-container>
    
                                        <tr mat-header-row *matHeaderRowDef="profileComponentsDisplayedColumns"></tr>
                                        <tr mat-row *matRowDef="let row; columns: profileComponentsDisplayedColumns"></tr>
    
                                    </table>
                                    <!-- <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator> -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="downloadExcelTemplateForm.get('packageProfileAlacarte')!.value=='A-LA-CARTE'">
                    <div class="table-container">
                        <div class="table">
                            <div class="header">
                                <div>
                                    <table mat-table [dataSource]="componentsDataSource" matSort>
                                        <ng-container matColumnDef="serialNumber">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
                                            <td mat-cell *matCellDef="let row; let i = index" (click)="showDetails(row)">
                                                {{ i + 1 }}
                                            </td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="component">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Component Name</th>
                                            <td mat-cell *matCellDef="let row"> {{row.componentName}} </td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="tat">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> TAT</th>
                                            <td mat-cell *matCellDef="let row"> {{row.tat}} </td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="rate">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Rate per check</th>
                                            <td mat-cell *matCellDef="let row"> {{row.rate}} </td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="details">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Details</th>
                                            <td mat-cell *matCellDef="let row"> <input [(ngModel)]="row.instructions"
                                                    value="row.instructions" type="text" maxlength="200"></td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="maxChecks">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Max Checks</th>
                                            <td mat-cell *matCellDef="let row"><input [(ngModel)]="row.maxChecks"
                                                    value="row.maxChecks" type="text" size="3" maxlength="3"></td>
                                        </ng-container>
    
                                        <ng-container matColumnDef="select">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Select</th>
                                            <td mat-cell *matCellDef="let row"> <mat-checkbox
                                                    [disabled]="row.instructions==null || row.instructions=='' || row.maxChecks==null || row.maxChecks <=0"
                                                    [checked]="row.selected" [(ngModel)]="row.selected"></mat-checkbox>
                                            </td>
                                        </ng-container>
    
                                        <tr mat-header-row *matHeaderRowDef="componentsDisplayedColumns"></tr>
                                        <tr mat-row *matRowDef="let row; columns: componentsDisplayedColumns"></tr>
    
                                    </table>
                                    <!-- <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator> -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </mat-card-content>
        <mat-card-footer class="footer">
            <div *ngIf="action=='DOWNLOAD-TEMPLATE'">
                <button matTooltip="Download Excel Template" mat-raised-button (click)="downloadExcelTemplate()"
                    color="primary">Download Excel Template<mat-icon>file_download</mat-icon></button>
            </div>
            <!-- <div *ngIf="action=='UPLOAD-DATA'" style="padding: 0px;" class="form-footer">
                <mat-label>Click here to select a file</mat-label>
                    <ngx-mat-file-input (change)="fileChanged($event)" accept=".xlsx"></ngx-mat-file-input>
                <button class="btn-rounded" (click)="uploadButtonClicked()">UploadExcel<mat-icon>file_upload</mat-icon></button>
            </div> -->
            <!-- updated-15sep25 -->
            <!-- <div *ngIf="action === 'UPLOAD-DATA'" class="form-footer" style="padding: 0px;">
                <label>Click here to select a file</label>
                <mat-form-field appearance="outline">
                    <ngx-mat-file-input (change)="fileChanged($event)" accept=".xlsx"></ngx-mat-file-input>
                </mat-form-field>
                <button class="btn-rounded" (click)="uploadButtonClicked()">
                    Upload Excel <mat-icon>file_upload</mat-icon>
                </button>
            </div> -->
            <div *ngIf="action=='UPLOAD-DATA'" fxFlexAlign="end" style="margin-right: 20px;margin-bottom: 20px;" >
                <div *ngIf="action=='UPLOAD-DATA'" fxFlexAlign="end" style="margin-right: 20px;margin-bottom: 20px;">
                    <div *ngIf="action=='UPLOAD-DATA'" fxFlexAlign="end" style="margin-right: 20px;margin-bottom: 20px;">
                        <div fxFlex="30%" fxFlexOffset="20px" style="margin-top:10px">
                            <button matTooltip="Upload Files" mat-raised-button color="primary" (click)="openUploadDialog()">
                                Upload Files<mat-icon>file_upload</mat-icon>
                            </button>
                        </div>
                    </div>
                
                </div>
            </div> 
            <!-- end15sep25 -->

        </mat-card-footer>
    
</div>