<!-- <div class="table-container">
  <div class="main-container">
    <h1 class="tagname">List of Checks</h1>
    <mat-divider style="margin: 20px; color: aqua; background-color: #33BABC; width: 100%;"></mat-divider>
    
    
    <div class="row" >
      <div class="col-sm" style="margin-left: -5px">
        <select class=" form-select" [(ngModel)]="selectedTab">
          <option value="NEWCHECKS">All - {{dataSource.data.length}}</option>
          <option value="NEWCHECKS">Yet To Initiate- {{dataSource.data.length}}</option>
          <option value="WIP">WIP- {{wipDataSource.data.length}}</option>
          <option value="ON-HOLD">Hold- {{onHoldDataSource.data.length}}</option>
          <option value="REJECTED">Rejected- {{rejectedDataSource.data.length}}</option>
          <option value="INSUFFICIENCY-CLEARED">Insufficiency Cleared- {{insufficiencyDataSource.data.length}}</option>
          <option value="INSUFFICIENCY-REJECTED">Insufficiency Rejected- {{insufficiencyRejectedDataSource.data.length}}</option>
          <option value="TODAYS-FOLLOW-UP">Today's Follow-Up- {{todayFollowUpDataSource.data.length}}</option>
        </select>
      </div>
      <div class="col-sm"  >
        <input style="height: 36px" matInput (keyup)="applyFilter($event)" placeholder="Search" #input>
      </div>
      <div class="col-sm" style="text-align: end;" >
        <button (click)="exportToExcel()" class="btn-rounded" style="margin-top: 5px;">Export</button>
      </div>
    </div>
    
    
    <div class="table" *ngIf="selectedTab === 'NEWCHECKS'">
      <div class="header">
        
        
        <div >
          <table mat-table [dataSource]="dataSource" matSort>
            
            <ng-container matColumnDef="serialNumber">
              <th mat-header-cell *matHeaderCellDef fxFlex="1%" mat-sort-header> SL No. </th>
              <td mat-cell *matCellDef="let row; let i = index" fxFlex="1%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
                {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
              </td>
            </ng-container>
            
            <ng-container matColumnDef="caseId">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Case Id  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
            </ng-container>
            
            <ng-container matColumnDef="checkId">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
            </ng-container>
            <ng-container matColumnDef="candidateName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Candidate Name </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
            </ng-container> 
            
            <ng-container matColumnDef="checkname">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
            </ng-container>
            
            <ng-container matColumnDef="tatstart">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>
            
            <ng-container matColumnDef="tatend">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>
            
            <ng-container matColumnDef="clientName">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Client</th>
              <td mat-cell *matCellDef="let row" fxFlex="5%" (click)="showDetails(row)">
                {{ row.clientName }}
              </td>
            </ng-container>
            
            <ng-container matColumnDef="Agging">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Aging</th>
              <td mat-cell *matCellDef="let row" fxFlex="5%">
                <span
                [ngClass]="{
                  'badge-red': row.AggingDays <= 3,
                  'badge-green': row.AggingDays > 3
                }"
                class="badge"
                >
                {{ row.Agging }}
              </span>
            </td>
          </ng-container>
          
          
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" [attr.colspan]="displayedColumns.length">No data matching the filter "{{input.value}}"</td>
          </tr>
          
        </table>
        
        <mat-paginator  #myPaginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
      </div>
      
    </div>
  </div>
  
  <div class="table" *ngIf="selectedTab === 'WIP'">
    <div class="header">
      
      <div >
        <table mat-table [dataSource]="wipDataSource" matSort>
          
          
          <ng-container matColumnDef="serialNumber">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
            <td mat-cell *matCellDef="let row; let i = index"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
              {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
            </td>
          </ng-container>
          
          
          <ng-container matColumnDef="caseId">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Id </th>
            <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
          </ng-container>
          
          <ng-container matColumnDef="checkId">
            <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
            <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
          </ng-container>
          
          <ng-container matColumnDef="candidateName">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Candidate Name </th>
            <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
          </ng-container>
          
          <ng-container matColumnDef="checkname">
            <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
            <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
          </ng-container>
          
          <ng-container matColumnDef="tatstart">
            <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
            <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
          </ng-container>
          
          <ng-container matColumnDef="tatend">
            <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
            <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
          </ng-container>
          
          
          <tr mat-header-row *matHeaderRowDef="rejectedDisplayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: rejectedDisplayedColumns;"></tr>
          
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" [attr.colspan]="rejectedDisplayedColumns.length">No data matching the filter "{{input.value}}"</td>
          </tr>
          
        </table>
        
        <mat-paginator  #myPaginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
      </div>
      
    </div>
  </div>
  <div class="table" *ngIf="selectedTab === 'ON-HOLD'">
    <div class="header">
      
      <div >
        <table mat-table [dataSource]="onHoldDataSource" matSort>
          
          
          <ng-container matColumnDef="serialNumber">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
            <td mat-cell *matCellDef="let row; let i = index"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
              {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
            </td>
          </ng-container>
          
          
          <ng-container matColumnDef="caseId">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Id </th>
            <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
          </ng-container>
          
          <ng-container matColumnDef="checkId">
            <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
            <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
          </ng-container>
          
          <ng-container matColumnDef="candidateName">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Candidate Name </th>
            <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
          </ng-container>
          
          <ng-container matColumnDef="checkname">
            <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
            <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
          </ng-container>
          
          <ng-container matColumnDef="tatstart">
            <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
            <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
          </ng-container>
          
          <ng-container matColumnDef="tatend">
            <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
            <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
          </ng-container>
          
          
          <tr mat-header-row *matHeaderRowDef="rejectedDisplayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: rejectedDisplayedColumns;"></tr>
          
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" [attr.colspan]="rejectedDisplayedColumns.length">No data matching the filter "{{input.value}}"</td>
          </tr>
          
        </table>
        
        <mat-paginator  #myPaginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
      </div>
      
    </div>
  </div>
  
  
  
  
  <div class="table" *ngIf="selectedTab === 'REJECTED'">
    <div class="header">
      
      
      
      
      <div >
        <table mat-table [dataSource]="rejectedDataSource" matSort>
          
          <ng-container matColumnDef="serialNumber">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
            <td mat-cell *matCellDef="let row; let i = index"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
              {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
            </td>
          </ng-container>
          
          <ng-container matColumnDef="caseId">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Id </th>
            <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
          </ng-container>
          
          <ng-container matColumnDef="checkId">
            <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
            <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
          </ng-container>
          
          <ng-container matColumnDef="candidateName">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> 
              Candidate Name </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
            </ng-container>
            
            <ng-container matColumnDef="checkname">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
            </ng-container>
            
            <ng-container matColumnDef="tatstart">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>
            
            <ng-container matColumnDef="tatend">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>
            
            <ng-container matColumnDef="clientName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                Client
              </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.clientName}} </td>
            </ng-container>
            
            <ng-container matColumnDef="subclientName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                Subclient
              </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.subclientName}} </td>
            </ng-container>
            
            
            
            
            
            <tr mat-header-row *matHeaderRowDef="rejectedDisplayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: rejectedDisplayedColumns;"></tr>
            
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" [attr.colspan]="rejectedDisplayedColumns.length">No data matching the filter "{{input.value}}"</td>
            </tr>
            
          </table>
          
          <mat-paginator  #myPaginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
        </div>
        
      </div>
    </div>
    
    
    <div class="table" *ngIf="selectedTab === 'INSUFFICIENCY-CLEARED'">
      <div class="header">
        
        
        <div >
          <table mat-table [dataSource]="insufficiencyDataSource" matSort>
            
            <ng-container matColumnDef="serialNumber">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
              <td mat-cell *matCellDef="let row; let i = index"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
                {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
              </td>
            </ng-container>
            
            <ng-container matColumnDef="caseId">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Id
              </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
            </ng-container>
            
            <ng-container matColumnDef="checkId">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
            </ng-container>
            
            <ng-container matColumnDef="candidateName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Candidate Name </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
            </ng-container>
            
            <ng-container matColumnDef="checkname">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
            </ng-container>
            
            <ng-container matColumnDef="tatstart">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>
            
            <ng-container matColumnDef="tatend">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>
            
            
            
            
            
            <tr mat-header-row *matHeaderRowDef="insufficiencyDisplayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: insufficiencyDisplayedColumns;"></tr>
            
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" [attr.colspan]="insufficiencyDisplayedColumns.length">No data matching the filter "{{input.value}}"</td>
            </tr>
            
          </table>
          
          <mat-paginator  #myPaginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
        </div>
        
      </div>
    </div>
    <div class="table" *ngIf="selectedTab === 'INSUFFICIENCY-REJECTED'">
      <div class="header">
        
        
        <div >
          <table mat-table [dataSource]="insufficiencyRejectedDataSource" matSort>
            
            <ng-container matColumnDef="serialNumber">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
              <td mat-cell *matCellDef="let row; let i = index"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
                {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
              </td>
            </ng-container>
            
            <ng-container matColumnDef="caseId">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Id
              </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
            </ng-container>
            
            <ng-container matColumnDef="checkId">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
            </ng-container>
            
            <ng-container matColumnDef="candidateName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Candidate Name </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
            </ng-container>
            
            <ng-container matColumnDef="checkname">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
            </ng-container>
            
            <ng-container matColumnDef="tatstart">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>
            
            <ng-container matColumnDef="tatend">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>
            
            
            
            
            
            <tr mat-header-row *matHeaderRowDef="insufficiencyRejectedDisplayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: insufficiencyRejectedDisplayedColumns;"></tr>
            
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" [attr.colspan]="insufficiencyRejectedDisplayedColumns.length">No data matching the filter "{{input.value}}"</td>
            </tr>
            
          </table>
          
          <mat-paginator  #myPaginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
        </div>
        
      </div>
    </div>
    
    <div class="table"  *ngIf="selectedTab === 'TODAYS-FOLLOW-UP'">
      <div class="header">
        
        
        <div >
          <table mat-table [dataSource]="todayFollowUpDataSource" matSort>
            
            <ng-container matColumnDef="serialNumber">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
              <td mat-cell *matCellDef="let row; let i = index"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
                {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
              </td>
            </ng-container>
            
            <ng-container matColumnDef="caseId">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Id
              </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
            </ng-container>
            
            <ng-container matColumnDef="checkId">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
            </ng-container>
            
            <ng-container matColumnDef="candidateName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Candidate Name </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
            </ng-container>
            
            <ng-container matColumnDef="checkname">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
            </ng-container>
            
            <ng-container matColumnDef="tatstart">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>
            
            <ng-container matColumnDef="tatend">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>
            
            
            
            
            
            <tr mat-header-row *matHeaderRowDef="todayFollowUpDisplayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: todayFollowUpDisplayedColumns;"></tr>
            
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" [attr.colspan]="todayFollowUpDisplayedColumns.length">No data matching the filter "{{input.value}}"</td>
            </tr>
            
          </table>
          
          <mat-paginator  #myPaginator [pageSizeOptions]="[10, 25, 100]" aria-label="Select page of users"></mat-paginator>
        </div>
        
      </div>
    </div>
  </div>
  
  
  
</div> -->
<!-- New code by sharath  -->
 <div class="table-container">
  <div class="main-container">
    <h1 class="tagname">List of Checks</h1>
    <!-- venky 10/10 added width -->
    <mat-divider style="margin: 20px; color: aqua; background-color: #33BABC; width: 100%;"></mat-divider>
    
  <div class="status-cards" style="display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 20px; margin-left: 40px;">
  <!-- <button class="status-card" 
          [ngClass]="{'active': selectedTab === 'NEWCHECKS'}"
          style="background: #e0f7fa;" 
          (click)="selectedTab = 'NEWCHECKS'">
    All - {{dataSource.data.length}}
  </button> -->

  <button class="status-card" 
          [ngClass]="{'active': selectedTab === 'NEWCHECKS'}"
          style="background: #fff3e0;" 
          (click)="selectedTab = 'NEWCHECKS'">
    Yet To Initiate - {{dataSource.data.length}}
  </button>

  <button class="status-card" 
          [ngClass]="{'active': selectedTab === 'WIP'}"
          style="background: #ffe0b2;" 
          (click)="selectedTab = 'WIP'">
    WIP - {{wipDataSource.data.length}}
  </button>

  <button class="status-card" 
          [ngClass]="{'active': selectedTab === 'REJECTED'}"
          style="background: #ec4454;" 
          (click)="selectedTab = 'REJECTED'">
    Rejected - {{rejectedDataSource.data.length}}
  </button>

  <button class="status-card" 
          [ngClass]="{'active': selectedTab === 'ON-HOLD'}"
          style="background: #d1c4e9;" 
          (click)="selectedTab = 'ON-HOLD'">
    Hold - {{onHoldDataSource.data.length}}
  </button>

  <button class="status-card" 
          [ngClass]="{'active': selectedTab === 'INSUFFICIENCY-CLEARED'}"
          style="background: #c8e6c9;" 
          (click)="selectedTab = 'INSUFFICIENCY-CLEARED'">
    Insufficiency Cleared - {{insufficiencyDataSource.data.length}}
  </button>

  <button class="status-card" 
          [ngClass]="{'active': selectedTab === 'INSUFFICIENCY-REJECTED'}"
          style="background: #f0f4c3;" 
          (click)="selectedTab = 'INSUFFICIENCY-REJECTED'">
    Insufficiency Rejected - {{insufficiencyRejectedDataSource.data.length}}
  </button>

  <button class="status-card" 
          [ngClass]="{'active': selectedTab === 'TODAYS-FOLLOW-UP'}"
          style="background: #b2ebf2;" 
          (click)="selectedTab = 'TODAYS-FOLLOW-UP'">
    Today's Follow-Up - {{todayFollowUpDataSource.data.length}}
  </button>
</div>

      <mat-divider style="margin: 20px; color: aqua; background-color: #33BABC; width: 100%;"></mat-divider>

    <!-- venky 10/10 added width -->

    <div class="row" >
      <!-- <mat-select (selectionChange)="tabsChanged($event)" placeholder="Type Of Checks">
        <mat-option value="NEWCHECKS">All - {{dataSource.data.length}} </mat-option>
        <mat-option value="NEWCHECKS">New Checks </mat-option>
        <mat-option value="WIP">WIP </mat-option>
        <mat-option value="REJECTED">Rejected </mat-option>
        <mat-option value="INSUFFICIENCY-CLEARED">Insufficiency Cleared </mat-option>
        <mat-option value="TODAYS-FOLLOW-UP">Today's Follow-Up </mat-option>
      </mat-select> -->

      <!-- Dropdown -->

       <div class="col-sm" style="margin-left: -5px">
        <select class=" form-select" [(ngModel)]="selectedTab">
          <option value="NEWCHECKS">All - {{dataSource.data.length}}</option>
          <option value="NEWCHECKS">Yet To Initiate- {{dataSource.data.length}}</option>
          <option value="WIP">WIP- {{wipDataSource.data.length}}</option>
          <option value="ON-HOLD">Hold- {{onHoldDataSource.data.length}}</option>
          <option value="REJECTED">Rejected- {{rejectedDataSource.data.length}}</option>
          <option value="INSUFFICIENCY-CLEARED">Insufficiency Cleared- {{insufficiencyDataSource.data.length}}</option>
          <option value="INSUFFICIENCY-REJECTED">Insufficiency Rejected- {{insufficiencyRejectedDataSource.data.length}}</option>
          <option value="TODAYS-FOLLOW-UP">Today's Follow-Up- {{todayFollowUpDataSource.data.length}}</option>
        </select>
      </div> 
     
      <div class="col-sm"  >
        <input style="height: 36px" matInput (keyup)="applyFilter($event)" placeholder="Search" #input>
      </div>
      <div class="col-sm" style="text-align: end;" >
        <button (click)="exportToExcel()" class="btn-rounded" style="margin-top: 5px;">Export</button>
      </div>
    </div>
    
    
    <div class="table" *ngIf="selectedTab === 'NEWCHECKS'">
      <div class="header">
        <!-- <div class="table-header">
          <div class="filter-card col-3 mb-3">
            <mat-label class="form-label">Filter</mat-label>
            <input matInput (keyup)="applyFilter($event)" placeholder="Search" #input> 
          </div>
          <button class="btn-rounded">Export</button>
        </div> -->
        
        <div >
          <table mat-table [dataSource]="dataSource" matSort>
            
            <!-- ID Column -->
            <ng-container matColumnDef="serialNumber">
              <th mat-header-cell *matHeaderCellDef fxFlex="1%" mat-sort-header> SL No. </th>
              <td mat-cell *matCellDef="let row; let i = index" fxFlex="1%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
                {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
              </td>
            </ng-container>
            
            <!-- Progress Column -->
            <ng-container matColumnDef="caseId">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Case Id  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
            </ng-container>
            
            <ng-container matColumnDef="checkId">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
            </ng-container>
            <!-- Name Column -->
            <ng-container matColumnDef="candidateName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Candidate Name </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
            </ng-container> 

            <ng-container matColumnDef="checkname">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
            </ng-container>

            <ng-container matColumnDef="tatstart">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>

            <ng-container matColumnDef="tatend">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>

            <!-- Client Name Column -->
<ng-container matColumnDef="clientName">
  <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Client</th>
  <td mat-cell *matCellDef="let row" fxFlex="5%" (click)="showDetails(row)">
    {{ row.clientName }}
  </td>
</ng-container>

<!-- Agging Column -->
<ng-container matColumnDef="Agging">
  <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Aging</th>
  <td mat-cell *matCellDef="let row" fxFlex="5%">
    <span
      [ngClass]="{
        'badge-red': row.AggingDays <= 3,
        'badge-amber': row.AggingDays > 3 && row.AggingDays <= 7,
        'badge-green': row.AggingDays > 7
      }"
      class="badge"
    >
      {{ row.Agging }}
    </span>
  </td>
</ng-container>

            
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" [attr.colspan]="displayedColumns.length">No data matching the filter "{{input.value}}"</td>
            </tr>
            
          </table>
          
          <mat-paginator  #myPaginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
        </div>
        
      </div>
    </div>
    
    <div class="table" *ngIf="selectedTab === 'WIP'">
      <div class="header">
        <!-- <div class="table-header">
          <div class="filter-card">
            <mat-label>Filter</mat-label>
            <input matInput (keyup)="applyFilter($event)" placeholder="Search" #input>
          </div>
          <button class="btn-rounded" (click)="addBranchDetailsClicked()">Add</button>
        </div> -->
        <div >
          <table mat-table [dataSource]="wipDataSource" matSort>
            
            
            <ng-container matColumnDef="serialNumber">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
              <td mat-cell *matCellDef="let row; let i = index"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
                {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
              </td>
            </ng-container>
            
            
            <ng-container matColumnDef="caseId">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Id </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
            </ng-container>
            
            <ng-container matColumnDef="checkId">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
            </ng-container>

            <ng-container matColumnDef="candidateName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Candidate Name </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
            </ng-container>

            <ng-container matColumnDef="checkname">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
            </ng-container>

            <ng-container matColumnDef="tatstart">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>

            <ng-container matColumnDef="tatend">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
            </ng-container>

            <!-- Client Name Column -->
<ng-container matColumnDef="clientName">
  <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Client</th>
  <td mat-cell *matCellDef="let row" fxFlex="5%" (click)="showDetails(row)">
    {{ row.clientName }}
  </td>
</ng-container>

<!-- Agging Column -->
<ng-container matColumnDef="Agging">
  <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Aging</th>
  <td mat-cell *matCellDef="let row" fxFlex="5%">
    <span
      [ngClass]="{
       'badge-red': row.AggingDays <= 3,
        'badge-amber': row.AggingDays > 3 && row.AggingDays <= 7,
        'badge-green': row.AggingDays > 7
      }"
      class="badge"
    >
      {{ row.Agging }}
    </span>
  </td>
</ng-container>
            
            
            <tr mat-header-row *matHeaderRowDef="rejectedDisplayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: rejectedDisplayedColumns;"></tr>
            
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" [attr.colspan]="rejectedDisplayedColumns.length">No data matching the filter "{{input.value}}"</td>
            </tr>
            
          </table>
          
          <mat-paginator  #myPaginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
        </div>
        
      </div>
    </div>
<!-- on hold  -->
<div class="table" *ngIf="selectedTab === 'ON-HOLD'">
  <div class="header">

    <div >
      <table mat-table [dataSource]="onHoldDataSource" matSort>
        
        
        <ng-container matColumnDef="serialNumber">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
          <td mat-cell *matCellDef="let row; let i = index"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
            {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
          </td>
        </ng-container>
        
        
        <ng-container matColumnDef="caseId">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Id </th>
          <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
        </ng-container>
        
        <ng-container matColumnDef="checkId">
          <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
          <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
        </ng-container>

        <ng-container matColumnDef="candidateName">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Candidate Name </th>
          <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
        </ng-container>

        <ng-container matColumnDef="checkname">
          <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
          <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
        </ng-container>

        <ng-container matColumnDef="tatstart">
          <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
          <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
        </ng-container>

        <ng-container matColumnDef="tatend">
          <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
          <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
        </ng-container>

        <!-- Client Name Column -->
<ng-container matColumnDef="clientName">
  <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Client</th>
  <td mat-cell *matCellDef="let row" fxFlex="5%" (click)="showDetails(row)">
    {{ row.clientName }}
  </td>
</ng-container>

<!-- Agging Column -->
<ng-container matColumnDef="Agging">
  <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Aging</th>
  <td mat-cell *matCellDef="let row" fxFlex="5%">
    <span
      [ngClass]="{
        'badge-red': row.AggingDays <= 3,
        'badge-amber': row.AggingDays > 3 && row.AggingDays <= 7,
        'badge-green': row.AggingDays > 7
      }"
      class="badge"
    >
      {{ row.Agging }}
    </span>
  </td>
</ng-container>
        
        
        <tr mat-header-row *matHeaderRowDef="rejectedDisplayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: rejectedDisplayedColumns;"></tr>
        
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" [attr.colspan]="rejectedDisplayedColumns.length">No data matching the filter "{{input.value}}"</td>
        </tr>
        
      </table>
      
      <mat-paginator  #myPaginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
    </div>
    
  </div>
</div>
 <!-- on hold  -->

    
    
    <div class="table" *ngIf="selectedTab === 'REJECTED'">
      <div class="header">
        <!-- <div class="table-header">
          <div class="filter-card">
            <mat-label>Filter</mat-label>
            <input matInput (keyup)="applyFilter($event)" placeholder="Search" #input>
          </div>
          <button class="btn-rounded" (click)="addBranchDetailsClicked()">Add</button>
        </div> -->
        
        
        
        <div >
          <table mat-table [dataSource]="rejectedDataSource" matSort>
            
            <!-- ID Column -->
            <ng-container matColumnDef="serialNumber">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
              <td mat-cell *matCellDef="let row; let i = index"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
                {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
              </td>
            </ng-container>
            
            <!-- Progress Column -->
            <ng-container matColumnDef="caseId">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Id </th>
              <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
            </ng-container>
            
            <ng-container matColumnDef="checkId">
              <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
              <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="candidateName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                Candidate Name </th>
                <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
              </ng-container>

              <ng-container matColumnDef="checkname">
                <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
                <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
              </ng-container>

              <ng-container matColumnDef="tatstart">
                <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
                <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
              </ng-container>
  
              <ng-container matColumnDef="tatend">
                <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
                <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
              </ng-container>
              
              <!-- Fruit Column -->
               <!-- added client column -->
              <ng-container matColumnDef="clientName">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                  Client
                </th>
                <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.clientName}} </td>
              </ng-container>
              
              <ng-container matColumnDef="subclientName">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                  Subclient
                </th>
                <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.subclientName}} </td>
              </ng-container>

            <!-- added agging column -->

              <ng-container matColumnDef="Agging">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                  Agging
                </th>
                <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> 
                 <span
      [ngClass]="{
        'badge-red': row.AggingDays <= 3,
        'badge-amber': row.AggingDays > 3 && row.AggingDays <= 7,
        'badge-green': row.AggingDays > 7
      }"
      class="badge"
    >
      {{ row.Agging }}
    </span>  
                </td>
              </ng-container>
              
              <!-- <ng-container matColumnDef="tatEndDate">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                  TAT End Date </th>
                  <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}} </td>
                </ng-container>
                
                <ng-container matColumnDef="componentDisplayName">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                    Component
                  </th>
                  <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}} </td>
                </ng-container>
                
                <ng-container matColumnDef="AllocatedDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                    Allocated Date </th>
                    <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.AllocatedDate}} </td>
                  </ng-container>
                  
                  
                  
                  <ng-container matColumnDef="displayStatus">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
                    <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.displayStatus}} </td>
                  </ng-container> -->
                  
                  <!-- <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Action </th>
                    <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.action}} </td>
                  </ng-container> -->
                  
                  
                  
                  <tr mat-header-row *matHeaderRowDef="rejectedDisplayedColumns"></tr>
                  <tr mat-row *matRowDef="let row; columns: rejectedDisplayedColumns;"></tr>
                  
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" [attr.colspan]="rejectedDisplayedColumns.length">No data matching the filter "{{input.value}}"</td>
                  </tr>
                  
                </table>
                
                <mat-paginator  #myPaginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
              </div>
              
            </div>
          </div>
          
          
          <div class="table" *ngIf="selectedTab === 'INSUFFICIENCY-CLEARED'">
            <div class="header">
              <!-- <div class="table-header">
                <div class="filter-card">
                  <mat-label>Filter</mat-label>
                  <input matInput (keyup)="applyFilter($event)" placeholder="Search" #input>
                </div>
                <button class="btn-rounded" (click)="addBranchDetailsClicked()">Add</button>
              </div> -->
              
              <div >
                <table mat-table [dataSource]="insufficiencyDataSource" matSort>
                  
                  <!-- ID Column -->
                  <ng-container matColumnDef="serialNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
                    <td mat-cell *matCellDef="let row; let i = index"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
                      {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
                    </td>
                  </ng-container>
                  
                  <!-- Progress Column -->
                  <ng-container matColumnDef="caseId">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Id
                    </th>
                    <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
                  </ng-container>
                  
                  <ng-container matColumnDef="checkId">
                    <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
                    <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
                  </ng-container>

                  <!-- Name Column -->
                  <ng-container matColumnDef="candidateName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Candidate Name </th>
                    <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
                  </ng-container>

                  <ng-container matColumnDef="checkname">
                    <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
                    <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
                  </ng-container>

                  <ng-container matColumnDef="tatstart">
                    <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
                    <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
                  </ng-container>
      
                  <ng-container matColumnDef="tatend">
                    <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
                    <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
                  </ng-container>
                  
                  <!-- Fruit Column -->
                  <!-- <ng-container matColumnDef="clientName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                      Client
                    </th>
                    <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.clientName}} </td>
                  </ng-container>
                  
                  <ng-container matColumnDef="subclientName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Subclient
                    </th>
                    <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.subclientName}} </td>
                  </ng-container> -->
                  
                  <!-- <ng-container matColumnDef="tatEndDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                      TAT End Date </th>
                      <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.state}} </td>
                    </ng-container>
                    
                    <ng-container matColumnDef="componentDisplayName">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                        Component
                      </th>
                      <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.country}} </td>
                    </ng-container>
                    
                    <ng-container matColumnDef="AllocatedDate">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Allocated Date
                      </th>
                      <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.country}} </td>
                    </ng-container>
                    
                    
                    <ng-container matColumnDef="displayStatus">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
                      <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.country}} </td>
                    </ng-container>
                    
                    
                    <ng-container matColumnDef="action">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Action </th>
                      <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.country}} </td>
                    </ng-container> -->
                    
                    <!-- Client Name Column -->
<ng-container matColumnDef="clientName">
  <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Client</th>
  <td mat-cell *matCellDef="let row" fxFlex="5%" (click)="showDetails(row)">
    {{ row.clientName }}
  </td>
</ng-container>

<!-- Agging Column -->
<ng-container matColumnDef="Agging">
  <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Aging</th>
  <td mat-cell *matCellDef="let row" fxFlex="5%">
    <span
      [ngClass]="{
        'badge-red': row.AggingDays <= 3,
        'badge-amber': row.AggingDays > 3 && row.AggingDays <= 7,
        'badge-green': row.AggingDays > 7
      }"
      class="badge"
    >
      {{ row.Agging }}
    </span>
  </td>
</ng-container>
                    
                    <tr mat-header-row *matHeaderRowDef="insufficiencyDisplayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: insufficiencyDisplayedColumns;"></tr>
                    
                    <tr class="mat-row" *matNoDataRow>
                      <td class="mat-cell" [attr.colspan]="insufficiencyDisplayedColumns.length">No data matching the filter "{{input.value}}"</td>
                    </tr>
                    
                  </table>
                  
                  <mat-paginator  #myPaginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
                </div>
                
              </div>
            </div>
            <!-- ///Insuff Rejected //// -->
            <div class="table" *ngIf="selectedTab === 'INSUFFICIENCY-REJECTED'">
              <div class="header">

                
                <div >
                  <table mat-table [dataSource]="insufficiencyRejectedDataSource" matSort>
                    
                    <!-- ID Column -->
                    <ng-container matColumnDef="serialNumber">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
                      <td mat-cell *matCellDef="let row; let i = index"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
                        {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
                      </td>
                    </ng-container>
                    
                    <!-- Progress Column -->
                    <ng-container matColumnDef="caseId">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Id
                      </th>
                      <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
                    </ng-container>
                    
                    <ng-container matColumnDef="checkId">
                      <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
                      <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
                    </ng-container>
  
                    <!-- Name Column -->
                    <ng-container matColumnDef="candidateName">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Candidate Name </th>
                      <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
                    </ng-container>
  
                    <ng-container matColumnDef="checkname">
                      <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
                      <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
                    </ng-container>

                    <ng-container matColumnDef="tatstart">
                      <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
                      <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
                    </ng-container>
        
                    <ng-container matColumnDef="tatend">
                      <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
                      <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
                    </ng-container>
                    

                      <!-- Client Name Column -->
<ng-container matColumnDef="clientName">
  <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Client</th>
  <td mat-cell *matCellDef="let row" fxFlex="5%" (click)="showDetails(row)">
    {{ row.clientName }}
  </td>
</ng-container>

<!-- Agging Column -->
<ng-container matColumnDef="Agging">
  <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Aging</th>
  <td mat-cell *matCellDef="let row" fxFlex="5%">
    <span
      [ngClass]="{
        'badge-red': row.AggingDays <= 3,
        'badge-amber': row.AggingDays > 3 && row.AggingDays <= 7,
        'badge-green': row.AggingDays > 7
      }"
      class="badge"
    >
      {{ row.Agging }}
    </span>
  </td>
</ng-container>
                      
                      
                      <tr mat-header-row *matHeaderRowDef="insufficiencyRejectedDisplayedColumns"></tr>
                      <tr mat-row *matRowDef="let row; columns: insufficiencyRejectedDisplayedColumns;"></tr>
                      
                      <tr class="mat-row" *matNoDataRow>
                        <td class="mat-cell" [attr.colspan]="insufficiencyRejectedDisplayedColumns.length">No data matching the filter "{{input.value}}"</td>
                      </tr>
                      
                    </table>
                    
                    <mat-paginator  #myPaginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
                  </div>
                  
                </div>
              </div>
            <!-- ///Insuff Rejected //// -->
            
            <div class="table"  *ngIf="selectedTab === 'TODAYS-FOLLOW-UP'">
              <div class="header">
                <!-- <div class="table-header">
                  <mat-form-field class="filter-input">
                    <mat-label>Filter</mat-label>
                    <input matInput (keyup)="applyFilter($event)" placeholder="Search" #input>
                  </mat-form-field>
                  
                  <button mat-icon-button class="add-button" (click)="addBranchDetailsClicked()">
                    <mat-icon>add</mat-icon>
                  </button>
                  
                  
                </div> -->
                <!-- <div class="table-header">
                  <div class="filter-card">
                    <mat-label>Filter</mat-label>
                    <input matInput (keyup)="applyFilter($event)" placeholder="Search" #input>
                  </div>
                  <button class="btn-rounded" (click)="addBranchDetailsClicked()">Add</button>
                </div> -->
                
                <div >
                  <table mat-table [dataSource]="todayFollowUpDataSource" matSort>
                    
                    <!-- ID Column -->
                    <ng-container matColumnDef="serialNumber">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> SL No. </th>
                      <td mat-cell *matCellDef="let row; let i = index"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}">
                        {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
                      </td>
                    </ng-container>
                    
                    <!-- Progress Column -->
                    <ng-container matColumnDef="caseId">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Case Id
                      </th>
                      <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.caseId}}</td>
                    </ng-container>
                    
                    <ng-container matColumnDef="checkId">
                      <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Id  </th>
                      <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.checkId}}</td>
                    </ng-container>

                    <!-- Name Column -->
                    <ng-container matColumnDef="candidateName">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Candidate Name </th>
                      <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.candidateName}} </td>
                    </ng-container>

                    <ng-container matColumnDef="checkname">
                      <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> Check Name  </th>
                      <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.componentDisplayName}}</td>
                    </ng-container>
                    
                    <ng-container matColumnDef="tatstart">
                      <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT Start  </th>
                      <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatStartDate  | date:'dd-MMM-yyyy'}}</td>
                    </ng-container>
        
                    <ng-container matColumnDef="tatend">
                      <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header> TAT End </th>
                      <td mat-cell *matCellDef="let row" fxFlex="5%"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.tatEndDate  | date:'dd-MMM-yyyy'}}</td>
                    </ng-container>
                    
                    <!-- Fruit Column -->
                    <!-- <ng-container matColumnDef="clientName">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> 
                        Client
                      </th>
                      <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.clientName}} </td>
                    </ng-container>
                    
                    <ng-container matColumnDef="subclientName">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Subclient
                      </th>
                      <td mat-cell *matCellDef="let row"  (click)="showDetails(row)"  [ngStyle]="{color:getClassToApply(row)}"> {{row.subclientName}} </td>
                    </ng-container> -->
                    
                    <!-- Client Name Column -->
<ng-container matColumnDef="clientName">
  <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Client</th>
  <td mat-cell *matCellDef="let row" fxFlex="5%" (click)="showDetails(row)">
    {{ row.clientName }}
  </td>
</ng-container>

<!-- Agging Column -->
<ng-container matColumnDef="Agging">
  <th mat-header-cell *matHeaderCellDef fxFlex="5%" mat-sort-header>Aging</th>
  <td mat-cell *matCellDef="let row" fxFlex="5%">
    <span
      [ngClass]="{
        'badge-red': row.AggingDays <= 3,
        'badge-amber': row.AggingDays > 3 && row.AggingDays <= 7,
        'badge-green': row.AggingDays > 7
      }"
      class="badge"
    >
      {{ row.Agging }}
    </span>
  </td>
</ng-container>
                    
                    
                    <tr mat-header-row *matHeaderRowDef="todayFollowUpDisplayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: todayFollowUpDisplayedColumns;"></tr>
                    
                    <tr class="mat-row" *matNoDataRow>
                      <td class="mat-cell" [attr.colspan]="todayFollowUpDisplayedColumns.length">No data matching the filter "{{input.value}}"</td>
                    </tr>
                    
                  </table>
                  
                  <mat-paginator  #myPaginator [pageSizeOptions]="[10, 25, 100]" aria-label="Select page of users"></mat-paginator>
                </div>
                
              </div>
            </div>
          </div>
          
          <!-- <div class="details" *ngIf="showDetailsFlag" >
            <div *ngIf="selectedRow">
              <app-analyst-component-verification [selectedRow]="selectedRow"></app-analyst-component-verification>
            </div>
          </div> -->
          
        </div>