const fs =require('fs');
const moment = require('moment');
const path = require('path');
const docx = require('docx');
const { FootNoteReferenceRunAttributes, TextRun } = require('docx');
const { resolve } = require('path');
const ColorMaster = require('../../models/administration/color_master.model')
const ClientContractPackage = require('../../models/administration/client_contract_package.model')
const ClientContractProfile = require('../../models/administration/client_contract_profile.model')
const Case = require('../../models/uploads/case.model');
const PersonalDetailsData = require('../../models/data_entry/personal_details_data.model')
const User = require('../../models/administration/user.model')
const ExcelJS = require('exceljs');
const UserRole = require('../../models/administration/user_role.model');
const ComponentAccess = require('../../models/administration/component_access.model')
const employment = require('../../models/data_entry/employment.model')
const education = require('../../models/data_entry/education.model');
const address = require('../../models/data_entry/address.model');
const courtrecord = require('../../models/data_entry/courtrecord.model');
const criminalrecord = require('../../models/data_entry/criminalrecord.model');
const identity = require('../../models/data_entry/identity.model');
const creditcheck = require('../../models/data_entry/creditcheck.model');
const socialmedia = require('../../models/data_entry/socialmedia.model');
const globaldatabase = require('../../models/data_entry/globaldatabase.model');
const reference = require('../../models/data_entry/reference.model');
const refbasic = require('../../models/data_entry/refbasic.model');
const drugtestfive = require('../../models/data_entry/drugtestfive.model');
const drugtestten = require('../../models/data_entry/drugtestten.model');
const passport = require('../../models/data_entry/passport.model');
const addresstelephone = require('../../models/data_entry/addresstelephone.model');
const addressonline = require('../../models/data_entry/addressonline.model');
const addresscomprehensive = require('../../models/data_entry/addresscomprehensive.model');
const educationcomprehensive = require('../../models/data_entry/educationcomprehensive.model');
const educationadvanced = require('../../models/data_entry/educationadvanced.model');
const drugtestsix =require('../../models/data_entry/drugtestsix.model');
const drugtestseven = require('../../models/data_entry/drugtestseven.model');
const drugtesteight = require('../../models/data_entry/drugtesteight.model');
const drugtestnine = require('../../models/data_entry/drugtestnine.model');
const facisl3 = require('../../models/data_entry/facisl3.model');
const credittrans = require('../../models/data_entry/credittrans.model');
const creditequifax = require('../../models/data_entry/creditequifax.model');
const empadvance = require('../../models/data_entry/empadvance.model');
const empbasic = require('../../models/data_entry/empbasic.model');
const vddadvance = require('../../models/data_entry/vddadvance.model');
const dlcheck =  require('../../models/data_entry/dlcheck.model');
const voterid = require('../../models/data_entry/voterid.model');
const ofac = require('../../models/data_entry/ofac.model');
const physostan = require('../../models/data_entry/physostan.model')
const gapvfn = require('../../models/data_entry/gapvfn.model')
const sitecheck = require('../../models/data_entry/sitecheck.model')
const bankstmt = require('../../models/data_entry/bankstmt.model')
const directorshipcheck = require('../../models/data_entry/directorshipcheck.model')
//const socialmedia = require('../../models/data_entry/socialmedia.model')
const pdf2img = require('pdf2img');
const isPDF = require('is-pdf-valid')

let allJpegs = new Array()
exports.standardWordReport = (req,res)=>{
 let colorMasterDetails = new Array()
 let execSumDet = new Array() 	
 let getColorMaster = function(){
   return new Promise((resolve,reject)=>{
      ColorMaster
      .find()
      .then(data=>{
	colorMasterDetails = data      
	resolve(data)      
      })
      .catch(err=>{
	reject()      
      })	   
   })	 
 }	 
 let getCamEmailId = function(camCode){
   return new Promise((resolve,reject)=>{
      User
      .findOne({_id:camCode})
      .then(data=>{
	 if(data != null){
	    resolve(data.userId)     
         }else{
	    reject(null)	 
	 }	 
      })	   
     .catch(err=>{
	 reject(null)    
     }) 	   
   })	 
 }	
 let getCaseDetails = function(){
    return new Promise((resolve,reject)=>{	 
       Case
       .findOne({caseId:req.params.caseId})
       .populate({path:'subclient',populate:{path:'client',populate:{path:'cam'}}})	    
       .then(data=>{
          resolve(data)     	 
       })
       .catch(err=>{
          reject()	    
      })
   }) 	    
 }	 

 let getPersonalDetailsFromDb = function(acase){
    return new Promise((resolve,reject)=>{
      PersonalDetailsData
      .findOne({case:acase})
      .then(data=>{
	 resolve(data)     
      })
      .catch(err=>{
	 reject()     
      })	    
    })	    
 }	
 function getPackageDetails(packageCode){
       ClientContractPackage
       .findOne({_id:packageCode})
       .then(data=>{
	 return data.name       
       })	    
       .catch(err=>{
	 return null      
       })	    
	 
 }	
 function getProfileDetails(profileCode){
       ClientContractProfile
       .findOne({_id:profileCode})
       .then(data=>{
	  return data.name     
       })	    
       .catch(err=>{
	 return null      
       })	 
 }	

 let getEmploymentDetails = function(acase){
        console.log("Trying to fetch employment details for case status report for the case ")
        return new Promise((resolve,reject)=>{
            employment
            .find({case:acase})
	    .populate({path:'case'})	
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
		for(let i=0; i < data.length;i++){
	          let item = data[i]		
                  let det  = ({
		     checkName:"Employment",
		     checkType:item.empstatus,
		     briefDetails:item.nameofemployer,
		     grade:item.grade	  
		  })
   		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/employment/" + item._id + "/proofofwork")
		  await new Promise(resolve => setTimeout(resolve, 10000));	
		  execSumDet.push(det)	
		}    

                resolve(data)
            })
            .catch(err=>{
                console.log("Error in writing tl pending for employment",err)
                reject()
            })
        })

    }


    let getEmpBasicDetails = function(acase){
        return new Promise((resolve,reject)=>{
            empbasic
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
	       console.log("In getEmpBasicDetails, data is ",data)	   
	       console.log("Case id in getEmpBasicDetails is ",acase)	    
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Employment",
                     checkType:item.empstatus,
                     briefDetails:item.nameofemployer,
                     grade:item.grade
                  })
		  console.log("In emp basic about to createJpgs")     
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/empbasic/" + item._id + "/proofofwork")		       
                  await new Promise(resolve => setTimeout(resolve, 10000));		       
		  execSumDet.push(det)     
                }
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }


   let getEmpAdvanceDetails = function(acase){
        return new Promise((resolve,reject)=>{
            empadvance
            .find({case:acase})
            .populate({path:'case'})	
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Employment",
                     checkType:item.empstatus,
                     briefDetails:item.nameofemployer,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/empadvance/" + item._id + "/proofofwork")     
                  await new Promise(resolve => setTimeout(resolve, 10000));		       
                  execSumDet.push(det)
                }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }


   let getEducationDetails = function(acase){
        console.log("In education details of tl pending")
        return new Promise((resolve,reject)=>{
            education
            .find({case:acase})
            .populate({path:'case'})	
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Education",
                     checkType:"",
                     briefDetails:item.nameofuniversity,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/education/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
                }
                resolve(data)
            })
            .catch(err=>{
                console.log("Error in tl pending education listing ",err)
                reject()
            })
        })

   }


   let getEducationAdvancedDetails = function(acase){
        return new Promise((resolve,reject)=>{
            educationadvanced
            .find({case:acase})
            .populate({path:'case'})	
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDtailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Education",
                     checkType:"",
                     briefDetails:item.nameofuniverskty,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/educationadvanced/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
                }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }

    let getEducationComprehensiveDetails = function(acase){
        return new Promise((resolve,reject)=>{
            educationcomprehensive
            .find({case:acase})
            .populate({path:'case'})	
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Education",
                     checkType:"",
                     briefDetails:item.nameofuniversity,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/educationcomprehensive/" + item._id + "/proofofwork")    
                  await new Promise(resolve => setTimeout(resolve, 10000));
                  execSumDet.push(det)
                }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }

    let getAddressDetails = function(acase){
        return new Promise((resolve,reject)=>{
            address
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Address",
                     checkType:item.typeofaddress,
                     briefDetails:item.address,
                     grade:item.grade
                  })
		  console.log("Sending for creating the jpgs of address")     
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/address/" + item._id + "/proofofwork")     
                  await new Promise(resolve => setTimeout(resolve, 10000));		       
                  execSumDet.push(det)
                }
		    
                resolve(data)
            })
            .catch(err=>{
                console.log("Error in address component ",err)
                reject()
            })
        })

   }


      let getAddressComprehensiveDetails = function(acase){
        return new Promise((resolve,reject)=>{
            addresscomprehensive
            .find({case:acase})
            .populate({path:'case'})	
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0;i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Address",
                     checkType:item.typeofaddress,
                     briefDetails:item.fulladdress,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/addresscomprehensive/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
                }

                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }


     let getAddressOnlineDetails = function(acase){
        return new Promise((resolve,reject)=>{
            addressonline
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Address",
                     checkType:item.typeofaddress,
                     briefDetails:item.fulladdwithpin,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/addressonline/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
                }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }
            

    let getAddressTelephoneDetails = function(acase){
        return new Promise((resolve,reject)=>{
            addresstelephone
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Address",
                     checkType:item.typeofaddress,
                     briefDetails:item.address,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/addresstelephone/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
                }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }
	

 let getCourtRecordDetails = function(acase){
        return new Promise((resolve,reject)=>{
            courtrecord
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Court Record",
                     checkType:item.typeofaddress,
                     briefDetails:item.addresswithpin,
                     grade:item.grade
                  })
          	  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/courtrecord/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
                }
		    
                resolve(data)
            })
            .catch(err=>{
                console.log("Error in court record check for tl pending ",err)
                reject()
            })
        })

    }

     let getCriminalRecordDetails = function(acase){
        return new Promise((resolve,reject)=>{
            criminalrecord
            .find({case:acase})
            .populate({path:'case'})	
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		 let item = data[i]    
                  let det = ({
                     checkName:"Criminal Record",
                     checkType:item.typeofaddress,
                     briefDetails:item.fulladdress,
                     grade:item.grade
                  })
                  execSumDet.push(det)
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/criminalrecord/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));
     
                }
	    
                resolve(data)
            })
            .catch(err=>{
                console.log("Error in criminal check for tl pending",err)
                reject()
            })
        })

    }
	
     let getReferenceDetails = function(acase){
        return new Promise((resolve,reject)=>{
            reference
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i  < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Reference",
                     checkType:"",
                     briefDetails:item.nameofreference,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/reference/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));     
     		  execSumDet.push(det)
	       }	    
               resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }
	
     let getRefBasicDetails = function(acase){
        return new Promise((resolve,reject)=>{
            refbasic
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Reference",
                     checkType:"",
                     briefDetails:item.name,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/refbasic/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }
    
    let getIdentityDetails = function(acase){
        return new Promise((resolve,reject)=>{
            identity
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Identity Check",
                     checkType:"",
                     briefDetails:item.typeofid,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/identity/" + item._id + "/proofofwork")    
                  await new Promise(resolve => setTimeout(resolve, 10000));		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
               reject()
		    
            })
        })

    }

    let getCreditCheckDetails = function(acase){
        return new Promise((resolve,reject)=>{
            creditcheck
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Credit Check",
                     checkType:"",
                     briefDetails:item.nameasperpan,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/creditcheck/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }	


    let getCreditTransDetails = function(acase){
        return new Promise((resolve,reject)=>{
            credittrans
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Credit Check",
                     checkType:"",
                     briefDetails:item.nameasperpan,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/credittrans/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }

    let getCreditEquifaxDetails = function(acase){
        return new Promise((resolve,reject)=>{
            creditequifax
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]      
                  let det = ({
                     checkName:"Credit Check",
                     checkType:"",
                     briefDetails:item.panname,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/creditequifax/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }
	
    let getGlobaldatabaseDetails = function(acase){
        return new Promise((resolve,reject)=>{
            globaldatabase
            .find({case:acase})
            .populate({path:'case'})	
	    .populate({path:'case',populate:{path:'subclient',populate:{path:'client'}}})	
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0;i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Global Database",
                     checkType:"",
                     briefDetails:item.searchname,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/globaldatabase/" + item._id + "/proofofwork")     
		   await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })
     }
	

    let getDrugTestFiveDetails = function(acase){
        return new Promise((resolve,reject)=>{
            drugtestfive
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Drug Test - 5 Panel",
                     checkType:"",
                     briefDetails:item.nameofemployee,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/drugtestfive/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }

    let getDrugTestSixDetails = function(acase){
        return new Promise((resolve,reject)=>{
            drugtestsix
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0;i < data.length;i++){
		  let item = data[i]      
                  let det = ({
                     checkName:"Drug Test - 6 Panel",
                     checkType:"",
                     briefDetails:item.nameofemployee,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/drugtestsix/" + item._id + "/proofofwork")     
		  await new Promise(resolve => setTimeout(resolve, 10000));     
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }

    let getDrugTestSevenDetails = function(acase){
        return new Promise((resolve,reject)=>{
            drugtestseven
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
                  let det = ({
                     checkName:"Drug Test - 7 Panel",
                     checkType:"",
                     briefDetails:item.nameofemployee,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/drugtestseven/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));

                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }


    let getDrugTestEightDetails = function(acase){
        return new Promise((resolve,reject)=>{
            drugtesteight
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Drug Test - 8 Panel",
                     checkType:"",
                     briefDetails:item.nameofemployee,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/drugtesteight/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));
		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }

    let getDrugTestNineDetails = function(acase){
        return new Promise((resolve,reject)=>{
            drugtestnine
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Drug Test - 9 Panel",
                     checkType:"",
                     briefDetails:"",
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/drugtestnine/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));
		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }

    let getDrugTestTenDetails = function(acase){
        return new Promise((resolve,reject)=>{
            drugtestten
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Drug Test - 10 Panel",
                     checkType:"",
                     briefDetails:item.nameofemployee,
                     grade:item.grade
                  })
		  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/drugtestten/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));
		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }
	
    let getDlCheckDetails = function(acase){
        return new Promise((resolve,reject)=>{
            dlcheck
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"DL Check",
                     checkType:"",
                     briefDetails:item.dlnumber,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/dlcheck/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));
		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }
	
    let getDirectorshipCheckDetails = function(acase){
        return new Promise((resolve,reject)=>{
            directorshipcheck
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Directorship Check",
                     checkType:"",
                     briefDetails:item.dinnumber,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/directorshipcheck/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }
	

    let getVoterIdDetails = function(acase){
	console.log("in voter id details")    
        return new Promise((resolve,reject)=>{
            voterid
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
	       console.log("Voter  id data is ",data)	    
               for(let i=0;i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Voter Id Details",
                     checkType:"",
                     briefDetails:item.epicnumber,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/voterid/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));
                  execSumDet.push(det)
               }
	       resolve(data)	    
            })
            .catch(err=>{
		console.log("Error in reading voter id details ",err)    
                reject()
            })
        })

    }

        let getVddAdvanceDetails = function(acase){
        return new Promise((resolve,reject)=>{
            vddadvance
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Vendor Due Deiligence",
                     checkType:"",
                     briefDetails:item.companyname,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/vddadvance/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }

    let getBankStmtDetails = function(acase){
        return new Promise((resolve,reject)=>{
            bankstmt
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Bank Statement",
                     checkType:"",
                     briefDetails:item.nameofbank,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/vddadvance/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));
		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }
	
    let getSiteCheckDetails = function(acase){
        return new Promise((resolve,reject)=>{
            sitecheck
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Site Check",
                     checkType:"",
                     briefDetails:item.name,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/sitecheck/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
	    
                reject()
            })
        })

    }
    let getPsychometricDetails = function(acase){
        return new Promise((resolve,reject)=>{
            physostan
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Psychometric Check",
                     checkType:"",
                     briefDetails:item.name,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/physostan/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));		       
                  execSumDet.push(det)
               }
		    
		resolve(data)    
	     })	    
            .catch(err=>{
                reject()
            })
        })
		
    }

    let getSocialMediaDetails = function(acase){
        return new Promise((resolve,reject)=>{
            console.log("In Social Media Details for case")		
            socialmedia
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
                  let det = ({
                     checkName:"Social Media",
                     checkType:"",
                     briefDetails:item.searchname,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/socialmedia/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
		console.log("Error in social media",err)    
                reject()
            })
        })
    }

    let getFacisl3Details = function(acase){
        return new Promise((resolve,reject)=>{
            facisl3
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Facis L3",
                     checkType:"",
                     briefDetails:item.applicantname,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/facisl3/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
	})
    }

    let getOfacDetails = function(acase){
        return new Promise((resolve,reject)=>{
            ofac
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"OFAC",
                     checkType:"",
                     briefDetails:item.candname,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/ofac/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }
		
    let getGapVfnDetails = function(acase){
        return new Promise((resolve,reject)=>{
            gapvfn
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Gap",
                     checkType:"",
                     briefDetails:item.address,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/gapvfn/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }
		
    let getPassportDetails = function(acase){
        return new Promise((resolve,reject)=>{
            passport
            .find({case:acase})
            .populate({path:'case'})		
            .populate({path:'verificationAllocatedTo'})
            .populate({path:'allocatedToFE'})
            .populate({path:'allocatedToVendor'})
            .populate({path:'component'})
            .populate({path:'personalDetailsData'})
            .then(async data=>{
               for(let i=0; i < data.length;i++){
		  let item = data[i]     
                  let det = ({
                     checkName:"Passport",
                     checkType:"",
                     briefDetails:item.passportnumber,
                     grade:item.grade
                  })
                  await createJpgs("/REPO_STORAGE/case_uploads/" + item.case.caseId + "/passport/" + item._id + "/proofofwork")
                  await new Promise(resolve => setTimeout(resolve, 10000));		       
                  execSumDet.push(det)
               }
		    
                resolve(data)
            })
            .catch(err=>{
                reject()
            })
        })

    }

    let getPersonalDetails = function(){ 
        return new Promise((resolve,reject)=>{
            let personalDetails = {candidateName:"Balakrishna Reddy",
            gender:"Male",
            dateOfBirth:"14-Oct-1980",
            dateInitiated:"28-May-2021",
            dateOfReport:"03-May-2021",
            caseId:"210528A0005B",
            empId:"",
            insuffRaisedDate:"",
            insuffClearedDate:"",
            subclient:"Bangalore",
            colorCode:"Verified Clear"
            }
            resolve(personalDetails)
        })
    }


    let getExecutiveSummaryDetails = function(){
        return new Promise((resolve,reject)=>{
            let executiveSummaryDetails = [{typeOfCheck:"Address",type:"Permanent",briefDetails:"No.465, 9th Main,Mahalakshmi Layout, Bangalore - 560018",status:"Verified Clear"},                      
            {typeOfCheck:"Address",type:"Present",briefDetails:"No.465, 9th Main,Mahalakshmi Layout, Bangalore - 560018",status:"Verified Clear"},                          
            {typeOfCheck:"Court Record",type:"Permanent",briefDetails:"No.465, 9th Main,Mahalakshmi Layout, Bangalore - 560018",status:"Verified Clear"},                              
            {typeOfCheck:"Education",type:"",briefDetails:"Bangalore University",status:"Verified Clear"},                                  
            {typeOfCheck:"Employment",type:"Current",briefDetails:"Tata Consultancy Services",status:""},                                      
            {typeOfCheck:"Employment",type:"Previous",briefDetails:"Infosys Limited",status:"Verified Clear"}]
            resolve(executiveSummaryDetails)
        })
    }
                                          
    let getClientNametable = function(clientName){
        return new  Promise((resolve,reject)=>{
            const clientNameTable = new docx.Table({
                rows:[new docx.TableRow({
                    children:[
                        new docx.TableCell({
                            width:{
                                size: 9000,
                                type: docx.WidthType.DXA,
                            },
                            shading:{
                                fill: "DCDCDC",
                                type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                color: "auto",
                            },
                            children:[new docx.Paragraph({
                                children:[
                                    new docx.TextRun({
                                        text:clientName,
                                        allCaps:true,
                                        font:"Calibri",
                                        bold:true,
                                        size:30
                                    })
                                ],
                                alignment:docx.AlignmentType.CENTER                        
                            })]
                        }),
                    ]
        
                })
              ]
            })
            resolve(clientNameTable)
        })
    }

    let getBlankLine = function(){
        return new Promise((resolve,reject)=>{
            const blankLine = new docx.Paragraph("")
            resolve(blankLine)            
        })

    }

    let  getReportTitleTable = function(caseDetails){
        return new Promise((resolve,reject)=>{
            const reportTitleTable = new docx.Table({
                rows:[new docx.TableRow({
                    children:[
                        new docx.TableCell({
                            width:{
                                size: 9000,
                                type: docx.WidthType.DXA,
                            },
                            shading:{
                                fill: "DCDCDC",
                                type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                color: "auto",
                            },
                            children:[new docx.Paragraph({
                                children:[
                                    new docx.TextRun({
     				        text:"BACKGROUND VERIFICATION FINAL REPORT",
                                        allCaps:true,
                                        font:"Calibri",
                                        bold:true,
                                        size:30
                                    })
                                ],
                                alignment:docx.AlignmentType.CENTER
                            })]
                        })
                    ]
        
                })
              ]
            })
            resolve(reportTitleTable)
        })
    }

    let getPersonalDetailsTable = function(caseDetails,personalDetailsFromDb){
        return new Promise((resolve,reject)=>{
            const personalDetailsTable = new docx.Table({
                rows:[
                    new docx.TableRow({
                        children:[
                            new docx.TableCell({
                                width:{
                                    size:2500,
                                    type:docx.WidthType.DXA,
                                },
                                shading:{
                                    fill: "DCDCDC",
                                    type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                    color: "auto",
                                },                        
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:"CANDIDATE NAME",
                                                font:"Calibri",
                                                bold:true                                        
                                            })                                          
                                        ]
        
                                    })
                                ],
        
                            }),
                            new docx.TableCell({
                                width:{
                                    size:2166,
                                    type:docx.WidthType.DXA,
                                },
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
						    text:personalDetailsFromDb != null ? personalDetailsFromDb.candidatename :caseDetails.candidateName,
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                                columnSpan:3
                            }),                    
         
                        ]
                    }),
                    new docx.TableRow({
                        children:[
                            new docx.TableCell({
                                width:{
                                    size:2500,
                                    type:docx.WidthType.DXA,
                                },
                                shading:{
                                    fill: "DCDCDC",
                                    type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                    color: "auto",
                                },                        
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:"Sub-Client",
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
        
                            }),
                            new docx.TableCell({
                                width:{
                                    size:2166,
                                    type:docx.WidthType.DXA,
                                },
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:caseDetails.subclient.name,
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                
                            new docx.TableCell({
                                width:{
                                    size:2166,
                                    type:docx.WidthType.DXA,
                                },
                                shading:{
                                    fill: "DCDCDC",
                                    type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                    color: "auto",
                                },                        
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:"DATE OF BIRTH",
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                                    
                            new docx.TableCell({
                                width:{
                                    size:2168,
                                    type:docx.WidthType.DXA,
                                },
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
						    text:personalDetailsFromDb != null ? moment(personalDetailsFromDb.dateofbirth).format('DD-MMM-yyyy'):"",
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                                                        
                        ]
                    }),
                    new docx.TableRow({
                        children:[
                            new docx.TableCell({
                                width:{
                                    size:2500,
                                    type:docx.WidthType.DXA,
                                },
                                shading:{
                                    fill: "DCDCDC",
                                    type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                    color: "auto",
                                },                        
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:"DATE INITIATED",
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
        
                            }),
                            new docx.TableCell({
                                width:{
                                    size:2166,
                                    type:docx.WidthType.DXA,
                                },
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:moment(caseDetails.initiationDate).format('DD-MMM-YYYY'),
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                
                            new docx.TableCell({
                                width:{
                                    size:2166,
                                    type:docx.WidthType.DXA,
                                },
                                shading:{
                                    fill: "DCDCDC",
                                    type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                    color: "auto",
                                },                        
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:"DATE OF REPORT",
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                                    
                            new docx.TableCell({
                                width:{
                                    size:2168,
                                    type:docx.WidthType.DXA,
                                },
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
						    text:caseDetails.outputqcCompletionDate==null?moment(new Date()).format("DD-MMM-YYYY"):moment(caseDetails.outputqcCompletionDate).format("DD-MMM-YYYY"),
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                                                        
                        ]
                    }),
                    new docx.TableRow({
                        children:[
                            new docx.TableCell({
                                width:{
                                    size:2500,
                                    type:docx.WidthType.DXA,
                                },
                                shading:{
                                    fill: "DCDCDC",
                                    type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                    color: "auto",
                                },                        
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:"VERIFACTS REFERENCE NO",
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
        
                            }),
                            new docx.TableCell({
                                width:{
                                    size:2166,
                                    type:docx.WidthType.DXA,
                                },
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:caseDetails.caseId,
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                
                            new docx.TableCell({
                                width:{
                                    size:2166,
                                    type:docx.WidthType.DXA,
                                },
                                shading:{
                                    fill: "DCDCDC",
                                    type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                    color: "auto",
                                },                        
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:"CLIENT REFERENCE NO",
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                                    
                            new docx.TableCell({
                                width:{
                                    size:2168,
                                    type:docx.WidthType.DXA,
                                },
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
						    text:personalDetailsFromDb != null ? personalDetailsFromDb.empid :"",
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                                                        
                        ]
                    }) ,
                    new docx.TableRow({
                        children:[
                            new docx.TableCell({
                                width:{
                                    size:2500,
                                    type:docx.WidthType.DXA,
                                },
                                shading:{
                                    fill: "DCDCDC",
                                    type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                    color: "auto",
                                },                        
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:"INSUFF RAISED ON",
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
        
                            }),
                            new docx.TableCell({
                                width:{
                                    size:2166,
                                    type:docx.WidthType.DXA,
                                },
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
						    text:caseDetails.firstInsufficiencyRaisedDate == null ?"":moment(caseDetails.firstInsufficiencyRaisedDate).format("DD-MMM-YYYY"),
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                
                            new docx.TableCell({
                                width:{
                                    size:2166,
                                    type:docx.WidthType.DXA,
                                },
                                shading:{
                                    fill: "DCDCDC",
                                    type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                    color: "auto",
                                },                        
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:"INSUFF CLEARED ON",
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                                    
                            new docx.TableCell({
                                width:{
                                    size:2168,
                                    type:docx.WidthType.DXA,
                                },
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
						    text:caseDetails.lastInsufficiencyClearedDate==null?"":moment(caseDetails.lastInsufficiencyClearedDate).format("DD-MMM-YYYY"),
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                                                        
                        ]
                    }) ,
                    new docx.TableRow({
                        children:[
                            new docx.TableCell({
                                width:{
                                    size:2500,
                                    type:docx.WidthType.DXA,
                                },
                                shading:{
                                    fill: "DCDCDC",
                                    type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                    color: "auto",
                                },                        
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:"LEVEL / ENTITY",
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
        
                            }),
                            new docx.TableCell({
                                width:{
                                    size:2166,
                                    type:docx.WidthType.DXA,
                                },
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
						    text:caseDetails.package != null ? getPackageDetails(caseDetails.package):(caseDetails.profile != null ? getProfileDetails(caseDetails.profile):""),
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                
                            new docx.TableCell({
                                width:{
                                    size:2166,
                                    type:docx.WidthType.DXA,
                                },
                                shading:{
                                    fill: "DCDCDC",
                                    type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                    color: "auto",
                                },                        
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
                                                text:"COLOR CODE",
                                                font:"Calibri",
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                                    
                            new docx.TableCell({
                                width:{
                                    size:2168,
                                    type:docx.WidthType.DXA,
                                },
                                children:[
                                    new docx.Paragraph({
                                        children:[
                                            new docx.TextRun({
						text:caseDetails.grade == null ? "In Progress":getColorCodeName(caseDetails.grade),
                                                font:"Calibri",
						color:caseDetails.grade == null ? "000000":getColorCode(caseDetails.grade),
						bold:caseDetails.grade == null ?false:true    
                                            })                                          
                                        ]
        
                                    })
                                ],
                            }),                                                        
                        ]
                    })                                                 
        
                ]
            })
            resolve(personalDetailsTable)            
        })

    }

    let getColorCodeTable = function(){
        return new Promise((resolve,reject)=>{
            const colorCodeTable = new docx.Table({
                rows:[new docx.TableRow({
                    children:[
                        new docx.TableCell({
                            width:{
                                size: 3000,
                                type: docx.WidthType.DXA,
                            },                    
                            borders:{
                                top: {style: docx.BorderStyle.SINGLE, size: 3, color: "CC0000"},
                                bottom: {style: docx.BorderStyle.SINGLE, size: 3, color: "CC0000"},
                                left: {style: docx.BorderStyle.SINGLE, size: 3, color: "CC0000"},
                                right: {style: docx.BorderStyle.SINGLE, size: 3, color: "CC0000"},
                            },
                            children:[
                                new docx.Paragraph({
                                   children:[
                                       new docx.TextRun({
                                        text: "Discrepancy",
                                        font:"Calibri",
                                        size:25,
                                        color:"CC0000",
                                        bold:true
                                       })
                                   ],
                                   alignment:docx.AlignmentType.CENTER                            
        
                                })                        
                            ]
                        }),
                        new docx.TableCell({
                            width:{
                                size: 3000,
                                type: docx.WidthType.DXA,
                            },     
                            borders:{
                                top: {style: docx.BorderStyle.SINGLE, size: 3, color: "FF9900"},
                                bottom: {style: docx.BorderStyle.SINGLE, size: 3, color: "FF9900"},
                                left: {style: docx.BorderStyle.SINGLE, size: 3, color: "FF9900"},
                                right: {style: docx.BorderStyle.SINGLE, size: 3, color: "FF9900"},  
                            },
                            children:[
                                new docx.Paragraph({
                                    children:[
                                        new docx.TextRun({
                                         text: "Unable to Verify",
                                         font:"Calibri",
                                         size:25,
                                         color:"FF9900",
                                         bold:true,
                                        })
                                    ],
                                    alignment:docx.AlignmentType.CENTER 
                                 }),
        
                            ]
                        }),
                        new docx.TableCell({
                            width:{
                                size: 3000,
                                type: docx.WidthType.DXA,
                            },                    
                            borders:{
                                top: {style: docx.BorderStyle.SINGLE, size: 3, color: "059142"},
                                bottom: {style: docx.BorderStyle.SINGLE, size: 3, color: "059142"},
                                left: {style: docx.BorderStyle.SINGLE, size: 3, color: "059142"},
                                right: {style: docx.BorderStyle.SINGLE, size: 3, color: "059142"},   
                            },                    
                            children:[
                                new docx.Paragraph({
                                    children:[
                                        new docx.TextRun({
                                         text: "Clear Report",
                                         font:"Calibri",
                                         size:25,
                                         color:"059142",
                                         bold:true
                                        })
                                    ], 
                                    alignment:docx.AlignmentType.CENTER
                                 })
                            ]
                        })                                
                    ]
        
                })
              ]
            })
            resolve(colorCodeTable)
        })
    }

    let getExecutiveSummaryTable = function(executiveSummaryDetails){
        return new Promise((resolve,reject)=>{
            let executiveSummaryTable = new docx.Table({
                rows:[
                    new docx.TableRow({
                        children:[
                            new docx.TableCell({
                                width:{
                                    size: 9000,
                                    type: docx.WidthType.DXA,
                                },
                                shading:{
                                    fill: "DCDCDC",
                                    type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                    color: "auto",
                                },
                                children:[new docx.Paragraph({
                                    children:[
                                        new docx.TextRun({
                                            text:"Executive Summary",
                                            allCaps:true,
                                            font:"Calibri",
                                            bold:true,
                                            size:25
                                        })
                                    ],
                                    alignment:docx.AlignmentType.CENTER                        
                                })],
                                columnSpan:3
                            }),
                        ]
                    }),
                    new docx.TableRow({
                        children:[
                            new docx.TableCell({
                                width:{
                                    size: 2000,
                                    type: docx.WidthType.DXA,
                                },
                                children:[new docx.Paragraph({
                                    children:[
                                        new docx.TextRun({
                                            text:"TYPES OF CHECK",
                                            allCaps:true,
                                            font:"Calibri",
                                            bold:true,
                                            size:20
                                        })
                                    ],
                                    alignment:docx.AlignmentType.CENTER                        
                                })]
                            }),
                            new docx.TableCell({
                                width:{
                                    size: 5000,
                                    type: docx.WidthType.DXA,
                                },
                                children:[new docx.Paragraph({
                                    children:[
                                        new docx.TextRun({
                                            text:"BRIEF DETAILS",
                                            allCaps:true,
                                            font:"Calibri",
                                            bold:true,
                                            size:20
                                        })
                                    ],
                                    alignment:docx.AlignmentType.CENTER                        
                                })]
                            }),            
                            new docx.TableCell({
                                width:{
                                    size: 2000,
                                    type: docx.WidthType.DXA,
                                },
                                children:[new docx.Paragraph({
                                    children:[
                                        new docx.TextRun({
                                            text:"BGC STATUS",
                                            allCaps:true,
                                            font:"Calibri",
                                            bold:true,
                                            size:20
                                        })
                                    ],
                                    alignment:docx.AlignmentType.CENTER                        
                                })]
                            }),                            
                        ]
                    }),                                         
                ]
            })
            resolve(executiveSummaryTable)
        })
    }
/*   function createJpgs(filePath){
     return new  Promise((resolve,reject)=>{	   
        if(fs.existsSync(filePath)){
            let  files = fs.readdirSync(filePath)
             for(let i=0 ; i < files.length;i++){
                if(path.extname(files[i]) != ".jpg"){
	          let input = filePath + "/" + files[i] 	    
	          let output = files[i].replace("'","")	     
                  pdf2img.setOptions({
                       type:'jpg',
                       size:1024,
                       density:600,
                       outputdir:filePath + "/",
                       outputname: output,
                       page:null,
                       quality:100
                  });
                  pdf2img.convert(input,function(err,info){
                     if(err){
                        console.log('error converting',err)
                     }else{
                        console.log('converted successfully',info)
                     }
                 })
          
                }
//               await new Promise(resolve => setTimeout(resolve,10000))		     
             }     
         }	     
	 resolve(true)    
      })     
   }	   */
   
   async function createJpgs(filePath){
//     return new  Promise((resolve,reject)=>{
        if(fs.existsSync(filePath)){
            let  files = fs.readdirSync(filePath)
             for(let i=0 ; i < files.length;i++){
                if(path.extname(files[i]) != ".jpg"){
                  let input = filePath + "/" + files[i]
                  let output = files[i].replace("'","")
                  console.log("File being considered for conversion",input)
		  const testFile = fs.readFileSync(input) 	
                  if(isPDF(testFile)){
                     await doActualConversion(input,output,filePath)
                  }
		
//                  await doActualConversion(input,output,filePath)

/*                  pdf2img.setOptions({
                       type:'jpg',
                       size:1024,
                       density:600,
                       outputdir:filePath + "/",
                       outputname: output,
                       page:null,
                       quality:100
                  });
                  pdf2img.convert(input,function(err,info){
                     if(err){
                        console.log('error converting',err)
                     }else{
                        console.log('converted successfully',info)
                     }
                 })*/
//               await new Promise(resolve => setTimeout(resolve,50000))
                }
//             await new Promise(resolve => setTimeout(resolve,50000))
             }
//           await new Promise(resolve => setTimeout(resolve,10000))
//             resolve(true)
         }
//            reject(false)
//       }
//       resolve(true)
//     })
   }

   function doActualConversion(input,output,filePath){
     return new Promise((resolve,reject)=>{
       console.log("In actual conversion file to convert is ",input)
        pdf2img.setOptions({
            type:'jpg',
            size:1024,
            density:600,
            outputdir:filePath + "/",
            outputname:output,
            page:null,
            quality:100
        });
        pdf2img.convert(input,function(err,info){
            if(err){
              reject(false)
              console.log('error covnerting',err)
            }else{
	      allJpegs.push(filePath)	    
              resolve(true)
//	      allJpegs.push(filePath)	    
              console.log('converted successfully',info)
            }
        })
//        resolve(true)
     })
   }



    let getAddressCheck = function(addressDetails){
	console.log("About to print addres sdetails")    
        return new Promise((resolve,reject)=>{
            let addressParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })
	   if(addressDetails == null){
		resolve(addressParagarph)   
           }		   
            for(let i=0; i < addressDetails.length;i++){
//               createJpgs("/REPO_STORAGE/case_uploads/"+ addressDetails[i].case.caseId + "/" + addressDetails[i]._id + "/proofofwork" )  
            let addressChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Address Verification",
                                font:"Calibri",
				size:25,
				bold:true

                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
   
                    }),
		    
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
				    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:addressDetails[i].grade == null ? "InProgress":getColorCodeName(addressDetails[i].grade),
                                font :"Calibri",
				color:addressDetails[i].grade == null ? "000000":getColorCode(addressDetails[i].grade),    
                                bold:addressDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
                   
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Address",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].address,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].addressRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Nearest Landmark",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].landmark,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].landmarkRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"City",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].city,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].cityRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Pin Code",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].pin,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].pinRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Tenure of Stay(mmm-yy to mmm-yy)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].tenureofstay,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].tenureofstayRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Address",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].typeofaddress,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].typeofaddressRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Stay",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].typeofstay,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].typeofstayRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Primary Contact Number",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].primarycontact,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].primarycontactRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Alternate Contact",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].alternatecontact,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].alternatecontactRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Respondent Name",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].nameofrespondentRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Respondent Contact",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].contactRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
				

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].mode,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Additional Comments",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            })
                        ]
		     })	    
                  
                ]
               })
//	      )
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + addressDetails[i].case.caseId + "/address/" + addressDetails[i]._id + "/proofofwork/")){
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + addressDetails[i].case.caseId + "/address/" + addressDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 addressChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + addressDetails[i].case.caseId + "/address/" + addressDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              addressParagraph.addChildElement(addressChildParagraph)
		    
		    
	    }	    
            resolve(addressParagraph)         
        })
    }
    let getAddressComprehensiveCheck = function(addressComprehensiveDetails){
        return new Promise((resolve,reject)=>{
	   let addressComprehensiveParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })
	    if(addressComprehensiveDetails == null){
	       resolve(addressComprehensiveParagraph)	    
            }		    
            for(let i=0; i < addressComprehensiveDetails.length;i++){		
              let addressComprehensiveChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Address Verification",
                                font:"Calibri",
				size:25,
				bold:true,    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:addressComprehensiveDetails[i].grade == null ? "InProgress":getColorCodeName(addressComprehensiveDetails[i].grade),
                                font :"Calibri",
                                color:addressComprehensiveDetails[i].grade == null ? "000000":getColorCode(addressComprehensiveDetails[i].grade),
                                bold:addressComprehensiveDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Address",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].fulladdress,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].fulladdressRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Nearest Landmark",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].landmark,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].landmarkRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"City",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].city,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].cityRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Pin Code",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].pin,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].pinRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Tenure of Stay(mmm-yy to mmm-yy)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].tenureofstay,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].tenureofstayRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Address",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].typeofaddress,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].typeofaddressRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Stay",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].typeofstay,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].typeofstayRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Primary Contact Number",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].primarycontact,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].primarycontactRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Alternate Contact",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].alternatecontact,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].alternatecontactRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Respondent Name",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].nameofrespondent,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].nameofrespondentRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Respondent Contact",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].contactofrespondentRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].mode,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Additional Comments",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressComprehensiveDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            })                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

                        ]
                    }),

                ]
            }) 
	    
	    if (fs.existsSync("/REPO_STORAGE/case_uploads/" + addressComprehensiveDetails[i].case.caseId + "/addresscomprehensive/" + addressComprehensiveDetails[i]._id + "/proofofwork/")){	    
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + addressComprehensiveDetails[i].case.caseId + "/addresscomprehensive/" + addressComprehensiveDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 addressComprehensiveChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + addressComprehensiveDetails[i].case.caseId + "/addresscomprehensive/" + addressComprehensiveDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              addressComprehensiveParagraph.addChildElement(addressComprehensiveChildParagraph)
		     

//	    )
	   }	    
            resolve(addressComprehensiveParagraph)         
        })
    }
    
    let getAddressOnlineCheck = function(addressOnlineDetails){
        return new Promise((resolve,reject)=>{
	    let addressOnlineParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(addressOnlineDetails == null){
	      resolve(addressOnlineParagraph) 	    
            }
	    for(let i=0; i < addressOnlineDetails.length;i++){	
             let addressOnlineChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Address Verification",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:addressOnlineDetails[i].grade == null ? "InProgress":getColorCodeName(addressOnlineDetails[i].grade),
                                font :"Calibri",
                                color:addressOnlineDetails[i].grade == null ? "000000":getColorCode(addressOnlineDetails[i].grade),
                                bold:addressOnlineDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Address",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].fulladdwithpin,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].fulladdwithpinRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Nearest Landmark",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].landmark,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].landmarkRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"City",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].city,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].cityRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Pin Code",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].pin,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].pinRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Tenure of Stay(mmm-yy to mmm-yy)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].tenure,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].tenureRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Address",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].typeofaddress,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].typeofaddressRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Stay",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].natureofstayRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Primary Contact Number",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].primarycontact,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].primarycontactRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Alternate Contact",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].alternatecontact,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].alternatecontact,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Geo Tag",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].geotagRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),                            
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Radius",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].radiusRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),                            
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Respondent Name",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].respondentnameRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Respondent Contact",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].contactofrespondentRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),

				
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].mode,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Additional Comments",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressOnlineDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            })                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

                        ]
                    }),

                ]
              })  
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + addressOnlineDetails[i].case.caseId + "/addressonline/" + addressOnlineDetails[i]._id + "/proofofwork/")){	    
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + addressOnlineDetails[i].case.caseId + "/addressonline/" + addressOnlineDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 addressOnlineChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + addressOnlineDetails[i].case.caseId + "/addressonline/" + addressOnlineDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              addressOnlineParagraph.addChildElement(addressOnlineChildParagraph)



//	      )
            }		    
            resolve(addressOnlineParagraph)         
        })
    }    
    let getAddressTelephoneCheck = function(addressTelephoneDetails){
        return new Promise((resolve,reject)=>{
	    let addressTelephoneParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(addressTelephoneDetails == null){
	       resolve(addressTelephoneParagraph)	    
            }		    
	    for(let i=0; i < addressTelephoneDetails.length;i++){
            let addressTelephoneChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Address Verification",
                                font:"Calibri",
				size:25,
				bold:true    
                            })
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:addressTelephoneDetails[i].grade == null ? "InProgress":getColorCodeName(addressTelephoneDetails[i].grade),
                                font :"Calibri",
                                color:addressTelephoneDetails[i].grade == null ? "000000":getColorCode(addressTelephoneDetails[i].grade),
                                bold:addressTelephoneDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Address",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].address,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].addressRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Nearest Landmark",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].landmark,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].landmarkRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"City",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].city,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].cityRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Pin Code",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].pin,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].pinRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Tenure of Stay(mmm-yy to mmm-yy)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].tenureofstay,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].tenureofstayRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Address",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].typeofaddress,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].typeofaddressRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Stay",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].typeofstayRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Primary Contact Number",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].primarycontact,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].primarycontactRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Alternate Contact",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].alternatecontact,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].alternatecontactRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Respondent Name",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].nameofrespondentRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Respondent Contact",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Call",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].dateofcallRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),                            
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].mode,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Additional Comments",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:addressTelephoneDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            })                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

                        ]
                    }),

                ]
              }) 
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + addressTelephoneDetails[i].case.caseId + "/addresstelephone/" + addressTelephoneDetails[i]._id + "/proofofwork/")){ 	    
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + addressTelephoneDetails[i].case.caseId + "/addresstelephone/" + addressTelephoneDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 addressTelephoneChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + addressTelephoneDetails[i].case.caseId + "/addresstelephone/" + addressTelephoneDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              addressTelephoneParagraph.addChildElement(addressTelephoneChildParagraph)



//	      )
	    }	    
            resolve(addressTelephoneParagraph)         
        })
    }
    let getCourtRecordCheck = function(courtRecordDetails){
        return new Promise((resolve,reject)=>{
	    let courtRecordParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(courtRecordDetails == null){
	      resolve(courtRecordParagraph)	    
	    }	    
	    for(let i=0; i < courtRecordDetails.length;i++){	
             let courtRecordChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Court Record Check Online",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:courtRecordDetails[i].grade == null ? "InProgress":getColorCodeName(courtRecordDetails[i].grade),
                                font :"Calibri",
                                color:courtRecordDetails[i].grade == null ? "000000":getColorCode(courtRecordDetails[i].grade),
                                bold:courtRecordDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Full Address with PIN",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].addresswithpinRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"PIN",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].pinRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"City",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].cityRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Address",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].typeofaddressRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Tenure of Stay (mmm-yy to mmm-yy)",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].tenureRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Supreme Court Records",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].supremecourtRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"High Court Records",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].highcourtRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"District Court Records",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].districtcourtRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Civil Court Records",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].civilcourtRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Magistrate Court Records",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].magistrateRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Session Court Records",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].sessionscourtRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:courtRecordDetails[i].dateofverificationRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].verifiedbyRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),                                                                                                                                                                                                                                                                                                                                                                            
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                    
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                           
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:courtRecordDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            })                                                                                    
                        ]
                    })

                ]
               }) 
	       if (fs.existsSync("/REPO_STORAGE/case_uploads/" + courtRecordDetails[i].case.caseId + "/courtrecord/" + courtRecordDetails[i]._id + "/proofofwork/")){	    
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + courtRecordDetails[i].case.caseId + "/courtrecord/" + courtRecordDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 courtRecordChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + courtRecordDetails[i].case.caseId + "/courtrecord/" + courtRecordDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              courtRecordParagraph.addChildElement(courtRecordChildParagraph)


//	      )
	     }	   
	    console.log("No problem in court record......... ")	
            resolve(courtRecordParagraph)         
        })
    }
   
    let getCreditCheck = function(creditCheckDetails){
        return new Promise((resolve,reject)=>{
	let creditCheckParagraph = new docx.Paragraph({
            children:[
                new docx.TextRun("")
            ]
        }) 	
        if(creditCheckDetails == null){
	  resolve(crediCheckParagraph)	
	}
	for(let i=0; i < creditCheckDetails.length;i++){	
          let creditCheckChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Credit Check - Basic",
                                font:"Calibri",
				size:25,
				bold:true    
                            })
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:creditCheckDetails[i].grade == null ? "InProgress":getColorCodeName(creditCheckDetails[i].grade),
                                font :"Calibri",
                                color:creditCheckDetails[i].grade == null ? "000000":getColorCode(creditCheckDetails[i].grade),
                                bold:creditCheckDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Income Tax ID (PAN)",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditCheckDetails[i].taxidRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Birth",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:creditCheckDetails[i].dateofbirthRhs != null ? moment(creditCheckDetails[i].dateofbirthRhs).format('DD-MMM-YYYY'):"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"CIBIL TRANSUNION SCORE",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditCheckDetails[i].creditscoreRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Scoring Factors",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"PERSONAL LOAN SCORE",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },     
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                          
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Scoring Factors",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Report Date",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:creditCheckDetails[i].reportdateRhs != null ? moment(creditCheckDetails[i].reportdateRhs).format('DD-MMM-YYYY'):"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditCheckDetails[i].reportbyRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditCheckDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),

                        ]
                    })

                ]
              })
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + creditCheckDetails[i].case.caseId + "/creditcheck/" + creditCheckDetails[i]._id + "/proofofwork/")){	
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + creditCheckDetails[i].case.caseId + "/creditcheck/" + creditCheckDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                creditCheckChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + creditCheckDetails[i].case.caseId + "/creditcheck/" + creditCheckDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              creditCheckParagraph.addChildElement(creditCheckChildParagraph)



//	      )
	    }	
            resolve(creditCheckParagraph)         
        })
    }

    let getCreditEquifaxCheck = function(creditEquifaxDetails){
        return new Promise((resolve,reject)=>{
        let creditEquifaxParagraph = new docx.Paragraph({
             children:[
                 new docx.TextRun("")
             ]
        })		
	if(creditEquifaxDetails == null){
	   resolve(creditEquifaxParagraph)	
	}	
        for(let i=0; i < creditEquifaxDetails.length;i++){		
         let creditEquifaxChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Credit Check - Equifax",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:creditEquifaxDetails[i].grade == null ? "InProgress":getColorCodeName(creditEquifaxDetails[i].grade),
                                font :"Calibri",
                                color:creditEquifaxDetails[i].grade == null ? "000000":getColorCode(creditEquifaxDetails[i].grade),
                                bold:creditEquifaxDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Income Tax ID (PAN)",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditEquifaxDetails[i].pannumberRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name as per PAN",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditEquifaxDetails[i].pannameRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Birth as per PAN",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditEquifaxDetails[i].dobofpanRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Gender",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditEquifaxDetails[i].genderRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Full Address with PIN",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditEquifaxDetails[i].fulladdressRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },     
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                          
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Contact Number",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditEquifaxDetails[i].contactRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Alternate Contact Number",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditEquifaxDetails[i].altcontactRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Credit Score",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditEquifaxDetails[i].creditscoreRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Scoring Factors",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Report Date",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:creditEquifaxDetails[i].reportdateRhs != null ? moment(creditEquifaxDetails[i].reportdateRhs).format('DD-MMM-YYYY'):"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditEquifaxDetails[i].reportedbyRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),                            
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditEquifaxDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),                            
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditEquifaxDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),                            

                        ]
                    })

                ]
              }) 
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + creditEquifaxDetails[i].case.caseId + "/ceditequifax/" + creditEquifaxDetails[i]._id + "/proofofwork/")){	
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + creditEquifaxDetails[i].case.caseId + "/ceditequifax/" + creditEquifaxDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 creditEquifaxChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + creditEqifaxDetails[i].case.caseId + "/creditequifax/" + creditEquifaxdDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              creditEquifaxParagraph.addChildElement(creditEquifaxChildParagraph)
//	      )
	    }
            resolve(creditEquifaxParagraph)         
        })
    }    

    let getCreditCheckTransunion = function(creditTransDetails){
        return new Promise((resolve,reject)=>{
	let creditCheckTransunionParagraph = new docx.Paragraph({
             children:[
                 new docx.TextRun("")
             ]
        })	
	if(creditTransDetails == null){
	   resolve(creditCheckTransunionParagraph)	
	}	
	for(let i=0; i < creditTransDetails.length;i++){
        let creditCheckTransunionChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Credit Check - Transunion",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:creditTransDetails[i].grade == null ? "InProgress":getColorCodeName(creditTransDetails[i].grade),
                                font :"Calibri",
                                color:creditTransDetails[i].grade == null ? "000000":getColorCode(creditTransDetails[i].grade),
                                bold:creditTransDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Income Tax ID (PAN)",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditTransDetails[i].pannumberRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name as per PAN",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditTransDetails[i].nameasperpanRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Birth as per PAN",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:creditTransDetails[i].dateofbirthRhs !=null ? moment(creditTransDetails[i].dateofbirthRhs).format('DD-MMM-YYYY'):"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Credit Score",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditTransDetails[i].creditscoreRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Scoring Factors",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },     
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                          
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Report Date",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:creditTransDetails[i].reportdateRhs != null ? moment(creditTransDetails[i].reportdateRhs).format('DD-MMM-YYYY'):"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditTransDetails[i].reportedbyRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditTransDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:creditTransDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                        ]
                    })

                ]
              })
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + creditTransDetails[i].case.caseId + "/credittrans/" + creditTransDetails[i]._id + "/proofofwork/"))	{
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + creditTransDetails[i].case.caseId + "/credittrans/" + creditTransDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 creditCheckTransunionChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + creditTransDetails[i].case.caseId + "/credittrans/" + creditTransDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
	      }	      
	      creditCheckTransunionParagraph.addChildElement(creditCheckTransunionChildParagraph)	
//	      )
	    }	
            resolve(creditCheckTransunionParagraph)         
        })
    }    
    let getCriminalRecordCheck = function(criminalRecordDetails){
        return new Promise((resolve,reject)=>{
	    let criminalRecordParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(criminalRecordDetails == null){
	       resolve(criminalRecordParagraph)	    
	    }	    
            for(let i=0; i < criminalRecordDetails.length;i++){	
//	       createJpgs("/REPO_STORAGE/case_uploads/"+ criminalRecordDetails[i].case.caseId + "/criminalrecord/" + criminalRecordDetails[i]._id + "/proofofwork" )
               let crimChildParagraph =  new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Criminal Record Check",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:criminalRecordDetails[i].grade == null ? "InProgress":getColorCodeName(criminalRecordDetails[i].grade),
                                font :"Calibri",
                                color:criminalRecordDetails[i].grade == null ? "000000":getColorCode(criminalRecordDetails[i].grade),
                                bold:criminalRecordDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of Police Station",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:criminalRecordDetails[i].nameofpolicestationRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Contact Number of Police Station",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:criminalRecordDetails[i].contactnumberRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Full Address with PIN",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:criminalRecordDetails[i].fulladdressRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"PIN",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:criminalRecordDetails[i].pinRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"City",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:criminalRecordDetails[i].cityRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Address",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:criminalRecordDetails[i].typeofaddres,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Tenure of Stay ( mmm-yy to mmm-yy)",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:criminalRecordDetails[i].tenureofstayRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Criminal Record Status",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:criminalRecordDetails[i].resultofvfnRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:criminalRecordDetails[i].nameanddesignationRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:criminalRecordDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:criminalRecordDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                        ]
                    })

                ]
   
              })
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + criminalRecordDetails[i].case.caseId + "/criminalrecord/" + criminalRecordDetails[i]._id + "/proofofwork/")){	    
	       let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + criminalRecordDetails[i].case.caseId + "/criminalrecord/" + criminalRecordDetails[i]._id + "/proofofwork/")
	       	    
	       for(let j=0 ; j < files.length;j++){ 
		 if(path.extname(files[j]) != ".jpg"){
		   continue	 
	         }		 
     
		 crimChildParagraph.addChildElement(new docx.Paragraph({
		    children:[
			 new docx.PageBreak(),   
			 new docx.ImageRun({
				 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + criminalRecordDetails[i].case.caseId + "/criminalrecord/" + criminalRecordDetails[i]._id + "/proofofwork/" + files[j]),
				 transformation:{
					 height:600,
					 width:600
				 }	 

			 })   
		    ]	 
		 }))     
	       }       
	      }    
	      criminalRecordParagraph.addChildElement(crimChildParagraph)	    
//	     )
	    }	    
            resolve(criminalRecordParagraph)         
        })
    }
    let getDirectorshipCheck = function(directorshipDetails){
        return new Promise((resolve,reject)=>{
	   let directorshipCheckParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(directorshipDetails == null){
	      resolve(directorshipCheckParagraph) 	    
            }		    
	    for(let i=0; i < directorshipDetails.length;i++){
             let directorshipCheckChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Directorship Check",
                                font:"Calibri",
				size:25,
				bold:true    
                            })
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:directorshipDetails[i].grade == null ? "InProgress":getColorCodeName(directorshipDetails[i].grade),
                                font :"Calibri",
                                color:directorshipDetails[i].grade == null ? "000000":getColorCode(directorshipDetails[i].grade),
                                bold:directorshipDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the Person",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:directorshipDetails[i].directorname,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:directorshipDetails[i].directornameRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Father's Name",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Birth",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:directorshipDetails[i].dob,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:directorshipDetails[i].dobRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DIN",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:directorshipDetails[i].dinnumber,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:directorshipDetails[i].dinnumberRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified On",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:directorshipDetails[i].verifiedonRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),

                        ]
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({

                            })                            
                        ]

                    }),
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:directorshipDetails[i].sourceRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:directorshipDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:directorshipDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            })                                                                                    
                        ]
                    })

                ]
              })  
//	      )
              if (fs.existsSync("/REPO_STORAGE/case_uploads/" + directorshipDetails[i].case.caseId + "/directorshipcheck/" + directorshipDetails[i]._id + "/proofofwork/")){
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + directorshipDetails[i].case.caseId + "/directorshipcheck/" + directorshipDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 directorshipCheckChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + directorshipDetails[i].case.caseId + "/directorshipcheck/" + directorshipDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              directorshipCheckChildParagraph.addChildElement(directorshipCheckChildParagraph)
		    
            }		    
            resolve(directorshipCheckParagraph)         
        })
    }
    let getDlCheck = function(dlCheckDetails){
        return new Promise((resolve,reject)=>{
	    let dlCheckParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })  
	    if(dlCheckDetails == null){
	      resolve(dlCheckParagraph)	    
            }		    
	    for(let i=0; i < dlCheckDetails.length;i++){
	     let dlCheckChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Driving License Check",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:dlCheckDetails[i].grade == null ? "InProgress":getColorCodeName(dlCheckDetails[i].grade),
                                font :"Calibri",
                                color:dlCheckDetails[i].grade == null ? "000000":getColorCode(dlCheckDetails[i].grade),
                                bold:dlCheckDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Driving License No.",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:dlCheckDetails[i].dlnumberRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name as per DL",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:dlCheckDetails[i].nameasperdlRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Birth",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:dlCheckDetails[i].dobRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DL Issue Date",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:dlCheckDetails[i].issueDateRhs != null ? moment(dlCheckDetails[i].issuedateRhs).format('DD-MMM-YYYY'):"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DL Valid Till",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:dlCheckDetails[i].dlvalidRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified On",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:dlCheckDetails[i].verifiedonRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:dlCheckDetails[i].verifiedbyRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:dlCheckDetails[i].sourceofvfnRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:dlCheckDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),

                        ]
                    })

                ]
               })  
//	      )
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + dlCheckDetails[i].case.caseId + "/dlcheck/" + dlCheckDetails[i]._id + "/proofofwork/")){
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + dlCheckDetails[i].case.caseId + "/dlcheck/" + dlCheckDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 dlCheckChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + dlCheckDetails[i].case.caseId + "/dlcheck/" + dlCheckDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              dlCheckParagraph.addChildElement(dlCheckChildParagraph)


	    }	    
            resolve(dlCheckParagraph)         
        })
    }
    let getDrugTestEightPanelCheck = function(drugtestEightDetails){
        return new Promise((resolve,reject)=>{
	    let drugTestEightParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(drugtestEightDetails == null){
	      resolve(drugTestEightParagraph)	    
            }
	    for(let i=0; i < drugtestEightDetails.length;i++){	
              let drugTestEightChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Drug Test - 8 Panel",
                                font:"Calibri",
				size:25,
				bold:true,    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:drugtestEightDetails[i].grade == null ? "InProgress":getColorCodeName(drugtestEightDetails[i].grade),
                                font :"Calibri",
                                color:drugtestEightDetails[i].grade == null ? "000000":getColorCode(drugtestEightDetails[i].grade),
                                bold:drugtestEightDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the Employee",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestEightDetails[i].nameofemployeeRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Lab Name",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestEightDetails[i].labnameRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Lab Reference Number",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestEightDetails[i].labrefRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Test",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:drugtestEightDetails[i].collectiondateRhs != null ? moment(drugtestEightDetails[i].collectiondateRhs).format('DD-MMM-YYYY'):"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Scope of Test",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"8 Panel",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Test Result",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestEightDetails[i].resultRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Additional Comments",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestEightDetails[i].verificationAllocatedTo.name,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestEightDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestEightDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),                            

                        ]
                    })

                ]
              })  
//	      )
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + drugtestEightDetails[i].case.caseId + "/drugtesteight/" + drugtestEightDetails[i]._id + "/proofofwork/")){	   
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + drugtestEightDetails[i].case.caseId + "/drugtesteight/" + drugtestEightDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 drugTestEightChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + drugtestEightDetails[i].case.caseId + "/drugtesteight/" + drugtestEightkDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              drugTestEightParagraph.addChildElement(drugTestEightChildParagraph)


	    }	    
            resolve(drugTestEightParagraph)         
        })
    }
    let getDrugTestFivePanelCheck = function(drugtestFiveDetails){
        return new Promise((resolve,reject)=>{
	    let drugTestFiveParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(drugtestFiveDetails == null){
		resolve(drugTestFiveParagraph)    
            }
	    for(let i=0; i < drugtestFiveDetails.length;i++){ 	
              drugTestFiveChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Drug Test - 5 Panel",
                                font:"Calibri",
				size:25,
				bold:true    
                            }), 
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:drugtestFiveDetails[i].grade == null ? "InProgress":getColorCodeName(drugtestFiveDetails[i].grade),
                                font :"Calibri",
                                color:drugtestFiveDetails[i].grade == null ? "000000":getColorCode(drugtestFiveDetails[i].grade),
                                bold:drugtestFiveDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the Employee",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestFiveDetails[i].nameofemployeeRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Lab Name",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestFiveDetails[i].labnameRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Lab Reference Number",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestFiveDetails[i].labrefRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Test",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:drugtestFiveDetails[i].sampledateRhs != null ? moment(drugtestFiveDetails[i].sampledateRhs).format('DD-MMM-YYYY'):"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Scope of Test",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"5 Panel",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Test Result",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestFiveDetails[i].testresultRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Additional Comments",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestFiveDetails[i].verificationAllocatedTo,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestFiveDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),                            

                        ]
                    })

                ]
              })  
//	      )
              if (fs.existsSync("/REPO_STORAGE/case_uploads/" + drugtestFiveDetails[i].case.caseId + "/drugtestfive/" + drugtestFiveDetails[i]._id + "/proofofwork/")){
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + drugtestFiveDetails[i].case.caseId + "/drugtestfive/" + drugtestFiveDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 drugTestFiveChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + drugtestFiveDetails[i].case.caseId + "/drugtestfive/" + drugtestFiveDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              drugTestFiveParagraph.addChildElement(drugTestFiveChildParagraph)
		    
            }		    
            resolve(drugTestFiveParagraph)         
        })
    }
    let getDrugTestNinePanelCheck = function(drugtestNineDetails){
        return new Promise((resolve,reject)=>{
	    let drugTestNineParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(drugtestNineDetails == null){
	      resolve(drugTestNineParagraph)	    
	    }	    
	    for(let i=0; i < drugtestNineDetails.length;i++){
	     drugTestNineChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Drug Test - 9 Panel",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:drugtestNineDetails[i].grade == null ? "InProgress":getColorCodeName(drugtestNineDetails[i].grade),
                                font :"Calibri",
                                color:drugtestNineDetails[i].grade == null ? "000000":getColorCode(drugtestNineDetails[i].grade),
                                bold:drugtestNineDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the Employee",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestNineDetails[i].case.candidateName,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Lab Name",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestNineDetails[i].labnameRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Lab Reference Number",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestNineDetails[i].labrefRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Test",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:drugtestNineDetails[i].collectiondateRhs != null ? moment(drugtestNineDetails[i].collectiondateRhs).format('DD-MMM-YYYY'):"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Scope of Test",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"9 Panel",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Test Result",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestNineDetails[i].resultRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Additional Comments",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestNineDetails[i].verificationAllocatedTo.name,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestNineDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestNineDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),                            

                        ]
                    })

                ]
              })  
//	      )
              if (fs.existsSync("/REPO_STORAGE/case_uploads/" + drugtestNineDetails[i].case.caseId + "/drugtestnine/" + drugtestNineDetails[i]._id + "/proofofwork/")){
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + drugtestNineDetails[i].case.caseId + "/drugtestnine/" + drugtestNineDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 drugTestNineChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + drugtestNineDetails[i].case.caseId + "/drugtestnine/" + drugtestNineDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              drugTestNineParagraph.addChildElement(drugTestNineChildParagraph)
		    
	    }	    
            resolve(drugTestNineParagraph)         
        })
    }        

    let getDrugTestSevenPanelCheck = function(drugtestSevenDetails){
        return new Promise((resolve,reject)=>{
	    let drugTestSevenParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(drugtestSevenDetails == null){
	       resolve(drugTestSevenParagraph)	    
	    }	    
	    for(let i=0; i < drugtestSevenDetails.length;i++){	
             drugTestSevenChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Drug Test - 7 Panel",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:drugtestSevenDetails[i].grade == null ? "InProgress":getColorCodeName(drugtestSevenDetails[i].grade),
                                font :"Calibri",
                                color:drugtestSevenDetails[i].grade == null ? "000000":getColorCode(drugtestSevenDetails[i].grade),
                                bold:drugtestSevenDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the Employee",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestSevenDetails[i].nameofemploybeeRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Lab Name",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestSevenDetails[i].labnameRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Lab Reference Number",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestSevenDetails[i].labrefnumberRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Test",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:drugtestSevenDetails[i].collectiondateRhs != null ? moment(drugtestSevenDetails[i].collectiondateRhs).format('DD-MMM-YYYY'):"" ,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Scope of Test",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"7 Panel",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Test Result",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestSevenDetails[i].testresultRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Additional Comments",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestSevenDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestSevenDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),                            

                        ]
                    })

                ]
              })  
//	      )
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + drugtestSevenDetails[i].case.caseId + "/drugtestseven/" + drugtestSevenDetails[i]._id + "/proofofwork/")){
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + drugtestSevenDetails[i].case.caseId + "/drugtestseven/" + drugtestSevenDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 drugTestSevenChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + drugtestSevenDetails[i].case.caseId + "/drugtestseven/" + drugtestSevenDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              drugTestSevenParagraph.addChildElement(drugTestSevenChildParagraph)
		    
            }
            resolve(drugTestSevenParagraph)         
        })
    }           
    let getDrugTestSixPanelCheck = function(drugtestSixDetails){
        return new Promise((resolve,reject)=>{
	    let drugTestSixParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(drugtestSixDetails == null){
	      resolve(drugTestSixParagraph)	    
            }		    
	    for(let i=0; i < drugtestSixDetails.length;i++){	
              drugTestSixChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Drug Test - 6 Panel",
                                font:"Calibri",
				size:25,
				bold:true    
                            })
			],
		        alignment:docx.AlignmentType.CENTER	    
		    }),    
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:drugtestSixDetails[i].grade == null ? "InProgress":getColorCodeName(drugtestSixDetails[i].grade),
                                font :"Calibri",
                                color:drugtestSixDetails[i].grade == null ? "000000":getColorCode(drugtestSixDetails[i].grade),
                                bold:drugtestSixDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the Employee",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestSixDetails[i].nameofemployeeRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Lab Name",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestSixDetails[i].labnameRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Lab Reference Number",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestSixDetails[i].labrefRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Test",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:drugtestSixDetails[i].collectionDateRhs != null ? moment(drugtestSixDetails[i].collectiondateRhs).format('DD-MMM-YYYY'):"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Scope of Test",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"6 Panel",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Test Result",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestSixDetails[i].resultRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Additional Comments",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestSixDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestSixDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),                            

                        ]
                    })

                ]
              })  
//	      )
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + drugtestSixDetails[i].case.caseId + "/drugtestsix/" + drugtestSixDetails[i]._id + "/proofofwork/")){
		    
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + drugtestSixDetails[i].case.caseId + "/drugtestsix/" + drugtestSixDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 drugTestSixChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + drugtestSixDetails[i].case.caseId + "/dlcheck/" + drugtestSixDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              drugtestSixParagraph.addChildElement(drugTestSixChildParagraph)
		    
	    }	    
            resolve(drugTestSixParagraph)         
        })
    }               
    
    let getDrugTestTenPanelCheck = function(drugtestTenDetails){
        return new Promise((resolve,reject)=>{
	    let drugTestTenParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(drugtestTenDetails == null){
	      resolve(drugTestTenParagraph)	    
	    }
	    for(let i=0; i < drugtestTenDetails.length;i++){	
             drugTestTenChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Drug Test - 10 Panel",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:drugtestTenDetails[i].grade == null ? "InProgress":getColorCodeName(drugtestTenDetails[i].grade),
                                font :"Calibri",
                                color:drugtestTenDetails[i].grade == null ? "000000":getColorCode(drugtestTenDetails[i].grade),
                                bold:drugtestTenDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the Employee",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestTenDetails[i].nameofemployeeRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Lab Name",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestTenDetails[i].labnameRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Lab Reference Number",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestTenDetails[i].labrefRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Test",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestTenDetails[i].samplecollectionRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Scope of Test",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"10 Panel",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Test Result",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestTenDetails[i].testresultRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Additional Comments",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestTenDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:drugtestTenDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),                            

                        ]
                    })

                ]
              })
//	      )
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + drugtestTenDetails[i].case.caseId + "/drugtestten/" + drugtestTenDetails[i]._id + "/proofofwork/")){
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + drugtestTenDetails[i].case.caseId + "/drugtestten/" + drugtestTenDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 drugTestTenChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + drugtestTenDetails[i].case.caseId + "/drugtestten/" + drugtestTenDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              drugTestTenParagraph.addChildElement(drugTestTenChildParagraph)

		    
	    }	    
            resolve(drugTestTenParagraph)         
        })
    }               
    let getEducationCheck = function(educationDetails){
        return new Promise((resolve,reject)=>{
	    let educationParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(educationDetails == null){
	      resolve(educationParagraph)	    
	    }	    
	    for(let i=0; i < educationDetails.length;i++){	
              educationChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Education Verification",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:educationDetails[i].grade == null ? "InProgress":getColorCodeName(educationDetails[i].grade),
                                font :"Calibri",
                                color:educationDetails[i].grade == null ? "000000":getColorCode(educationDetails[i].grade),
                                bold:educationDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Qualification Attained",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].qualification,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].qualificationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Specialization",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].specialization,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].specializationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the University",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].nameofuniversity,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].nameofuniversityRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the School",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].nameofschool,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].nameofschoolRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
				
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Duration of Study (from / to)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].yearofjoining + " / " + educationDetails[i].yearofcompletion,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].yearofjoiningRhs + " / " + educationDetails[i].yearofcompletionRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"City of Study",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].cityofstudy,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].cityofstudyRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Qualification",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].typeofqualification,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].typeofqualificationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Roll / Regd Number",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].rollnumber,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].rollnumberRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Marks / Div / % / CGPA",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].marks,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].marksRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
						        text:"Name of Respondent",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },

                                       children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].nameofrespondentRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Contact  of Respondent",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },

                                       children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].contactofrespondRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
				
				
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Email of Respondent",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].emailofrespondentRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },

                                       children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },

                                       children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
				

                        ]
                    }),

                ]
              })  
//	     ) 
	     if(fs.existsSync("/REPO_STORAGE/case_uploads/" + educationDetails[i].case.caseId + "/education/" + educationDetails[i]._id + "/proofofwork/")){	    
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + educationDetails[i].case.caseId + "/education/" + educationDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 educationChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + educationDetails[i].case.caseId + "/education/" + educationDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              educationParagraph.addChildElement(educationChildParagraph)
		    
	    }	      
            resolve(educationParagraph)         
        })
    }
    let getEducationAdvancedCheck = function(educationAdvancedDetails){
        return new Promise((resolve,reject)=>{
	    let educationAdvancedParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(educationAdvancedDetails == null){
	       resolve(educationAdvancedParagraph)	    
            }		    
	    for(let i=0; i < educationAdvancedDetails.length;i++){	
              educationAdvancedChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Education Verification",
                                font:"Calibri",
				size:25,
				bold:true    
                            })
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
				    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:educationAdvancedDetails[i].grade == null ? "InProgress":getColorCodeName(educationAdvancedDetails[i].grade),
                                font :"Calibri",
                                color:educationAdvancedDetails[i].grade == null ? "000000":getColorCode(educationAdvancedDetails[i].grade),
                                bold:educationAdvancedDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Qualification Attained",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].qualification,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].qualificatioinRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Specialization",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].specialization,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].specializationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the University",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].nameofuniverskty,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].nameofuniversktyRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the School",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].nameofschool,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].nameofschoolRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
		
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Duration of Study (from / to)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].yearofjoining + " / " + educationAdvancedDetails[i].yearofcompletion,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].yearofjoiningRhs + " / " + educationAdvancedDetails[i].yearofcompletion,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"City of Study",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].cityofstudy,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].cityofstudyRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Qualification",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].typeofqualification,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].typeofqualificationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Roll / Regd Number",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].rollnumber,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].rollnumberRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Marks / Div / % / CGPA",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].marks,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].marksRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of Respondent",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].nameofrespondentRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Contact of Respondent",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                           new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].contactofrespondentRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Email of Respondent",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                           new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].emailofrespondentRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                           new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                           new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationAdvancedDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),

                        ]
                    }),

                ]
              })
//	     )
	     if (fs.existsSync("/REPO_STORAGE/case_uploads/" + educationAdvancedDetails[i].case.caseId + "/educationadvanced/" + educationAdvancedDetails[i]._id + "/proofofwork/")){
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + educationAdvancedDetails[i].case.caseId + "/educationadvanced/" + educationAdvancedDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 educationAdvancedChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + educationAdvancedDetails[i].case.caseId + "/educationadvanced/" + educationAdvancedDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
             } 
              educationAdvancedParagraph.addChildElement(educationAdvancedChildParagraph)


	    }	    
            resolve(educationAdvancedParagraph)         
        })
    }
    let getEducationComprehensiveCheck = function(educationComprehensiveDetails){
        return new Promise((resolve,reject)=>{
	    let educationComprehensiveParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(educationComprehensiveDetails == null){
	      resolve(educationComprehensiveParagraph)	    
            }		    
            for(let i=0; i < educationComprehensiveDetails.length;i++){		
              educationComprehensiveChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Education Verification",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:educationComprehensiveDetails[i].grade == null ? "InProgress":getColorCodeName(educationComprehensiveDetails[i].grade),
                                font :"Calibri",
                                color:educationComprehensiveDetails[i].grade == null ? "000000":getColorCode(educationComprehensiveDetails[i].grade),
                                bold:educationComprehensiveDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Qualification Attained",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].qualification,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].qualificationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Specialization",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].specialization,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].speicializationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the University",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].nameofuniversity,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].nameofuniveristyRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
  						        text:"Name of the School",    
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].nameofschool,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].nameofschoolRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),


                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Duration of Study (from / to)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].yearofjoining + " / " + educationComprehensiveDetails[i].yearofcompletion,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].yearofjoiningRhs + " / " + educationComprehensiveDetails[i].yearofcompletionRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"City of Study",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].cityofstudy,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].cityofstudyRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Qualification",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].typeofqualification,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].typeofqualificationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Roll / Regd Number",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].rollnumber,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].rollnumberRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Marks / Div / % / CGPA",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].marks,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].marksRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of Respondent",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].nameofrespondentRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Contact of Respondent",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].contactofrespondentRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Email of Respondent",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].emailofrespondentRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"University Genuineness",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].universitygenRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[

                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[

                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:educationComprehensiveDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
				
				

                        ]
                    }),

                ]
              })  
//	     )
	     if (fs.existsSync("/REPO_STORAGE/case_uploads/" + educationComprehensiveDetails[i].case.caseId + "/educationcomprehensive/" + educationComprehensiveDetails[i]._id + "/proofofwork/")){ 
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + educationComprehensiveDetails[i].case.caseId + "/educationcomprehensive/" + educationComprehensiveDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 educationComprehensiveChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + educationComprehensiveDetails[i].case.caseId + "/educationcomprehensive/" + educationComprehensiveDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              educationComprehensiveParagraph.addChildElement(educationComprehensiveChildParagraph)
		      
		      
            }		    
            resolve(educationComprehensiveParagraph)         
        })
    }
    let getEmploymentAdvancedCheck = function(empAdvancedDetails){
        return new Promise((resolve,reject)=>{
	    let employmentAdvancedParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(empAdvancedDetails == null){
	       resolve(employmentAdvancedParagraph)	    
	    }	    
            for(let i=0; i < empAdvancedDetails.length;i++){	   	
              employmentAdvancedChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Employment Verification",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:empAdvancedDetails[i].grade == null ? "InProgress":getColorCodeName(empAdvancedDetails[i].grade),
                                font :"Calibri",
                                color:empAdvancedDetails[i].grade == null ? "000000":getColorCode(empAdvancedDetails[i].grade),
                                bold:empAdvancedDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of Company (and branch worked in)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].nameofemployer,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].nameofemployerRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Designation",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].designation,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].designationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Branch / City",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].branch,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].branchRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Deputed to (if available)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].deputedto,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].deputedtoRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Employment Status",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].empstatus,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].empstatusRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Employee Code / ID",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].empid,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].empidRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Period of Employment",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:(empAdvancedDetails[i].doj != null ? moment(empAdvancedDetails[i].doj).format('DD-MMM-YYYY') : "")+ " - " +empAdvancedDetails[i].lwd,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:(empAdvancedDetails[i].dojRhs != null ? moment(empAdvancedDetails[i].dojRhs).format('DD-MMM-YYYY'):"") + " - " + empAdvancedDetails[i].lwdRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remuneration (start and end)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Reporting Manager (Name and Designation)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].reportingmgr,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].reportingmgrRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Reasons for Leaving",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].reasonforleaving,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].reasonforleavingRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),                            
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"CIN",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].cinnumber,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].cinnumberRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),                                  
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Physical Verification Comments",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of Respondent",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].nameofrespondentRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Contact of Respondent",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].contactofrespondetRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
				
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empAdvancedDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
				

                        ]
                    }),

                ]
              })  
//	     )
	     if (fs.existsSync("/REPO_STORAGE/case_uploads/" + empAdvancedDetails[i].case.caseId + "/empadvance/" + empAdvancedDetails[i]._id + "/proofofwork/")){ 
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + empAdvancedDetails[i].case.caseId + "/empadvance/" + empAdvancedDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 employmentAdvancedChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + empAdvancedDetails[i].case.caseId + "/empadvance/" + empAdvancedDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              employmentAdvancedParagraph.addChildElement(employmentAdvancedChildParagraph)
		    
	    }	    
            resolve(employmentAdvancedParagraph)         
        })
    }
    let getEmploymentBasicCheck = function(empBasicDetails){
        return new Promise((resolve,reject)=>{
            let employmentBasicParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })		
	    if(empBasicDetails == null){
	      resolve(employmentBasicParagraph) 	    
	    }	    
	    for(let i=0; i < empBasicDetails.length;i++){	
            employmentBasicChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Employment Verification",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:empBasicDetails[i].grade == null ? "InProgress":getColorCodeName(empBasicDetails[i].grade),
                                font :"Calibri",
                                color:empBasicDetails[i].grade == null ? "000000":getColorCode(empBasicDetails[i].grade),
                                bold:empBasicDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of Company (and branch worked in)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].nameofemployer,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].nameofemployerRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Designation",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].designation,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].designationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Branch / City",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].branch,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].branchRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Deputed to (if available)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].deputedto,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].deptutedtoRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Employment Status",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].empstatus,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].empstatusRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Employee Code / ID",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].empid,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].empidRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Period of Employment",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:(empBasicDetails[i].doj != null ? moment(empBasicDetails[i].doj).format('DD-MMM-YYYY'):"") + " - " + empBasicDetails[i].lwd,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:(empBasicDetails[i].dojRhs != null ? moment(empBasicDetails[i].dojRhs).format('DD-MMM-YYYY') : "")+ " - " + empBasicDetails[i].lwdRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remuneration (start and end)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Reporting Manager (Name and Designation)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].reportingmgr,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].reportingmgrRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Reasons for Leaving",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].reasonforleaving,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].reasonforleavingRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),                           

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the Respondent",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].nameofrespndentRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Contact of the Respondent",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].contactofrespondentRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
				
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
				
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:empBasicDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),

                        ]
                    }),

                ]
              })  
//	      )
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + empBasicDetails[i].case.caseId + "/empbasic/" + empBasicDetails[i]._id + "/proofofwork/")){
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + empBasicDetails[i].case.caseId + "/empbasic/" + empBasicDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 employmentBasicChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + empBasicDetails[i].case.caseId + "/empbasic/" + empBasicDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              employmentBasicParagraph.addChildElement(employmentBasicChildParagraph)
		    
		    
	    }	    
            resolve(employmentBasicParagraph)         
        })
    }

    let getEmploymentComprehensiveCheck = function(employmentDetails){
   
        return new Promise((resolve,reject)=>{
	    let employmentParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(employmentDetails == null){
	      resolve(employmentParagraph)	    
	    }	    
	    for(let i=0; i < employmentDetails.length;i++){	
            employmentChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Employment Verification",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:employmentDetails[i].grade == null ? "InProgress":getColorCodeName(employmentDetails[i].grade),
                                font :"Calibri",
                                color:employmentDetails[i].grade == null ? "000000":getColorCode(employmentDetails[i].grade),
                                bold:employmentDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of Company (and branch worked in)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].nameofemployer,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].nameofemployerRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Designation",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].designation,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].designationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Branch / City",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].branch,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].branchRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Deputed to (if available)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].deputedto,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].deputedtoRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Employment Status",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].empstatus,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].empstatusRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Employee Code / ID",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].empid,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].empidRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Period of Employment",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:(employmentDetails[i].doj != null ? moment(employmentDetails[i].doj).format('DD-MMM-YYYY') : "")  + " - " + employmentDetails[i].lwd,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
							    text:(employmentDetails[i].dojRhs != null ? moment(employmentDetails[i].dojRhs).format('DD-MMM-YYYY'):"") + " - " + employmentDetails[i].lwdRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remuneration (start and end)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Reporting Manager (Name and Designation)",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].reportingmgr,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].reportingmgrRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Reasons for Leaving",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].reasonforleaving,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].reasonforleavingRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),                            
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"CIN",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].cinnumberRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),                                  
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Physical Verification Comments",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].physicalverificationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),         

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of the Respondent",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].nameofrespondRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Contact of the Respondent",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].contactofrespondRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:employmentDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })
                                ]
                            }),
				

                        ]
                    }),
                ]
              })  
//	     )
	     if (fs.existsSync("/REPO_STORAGE/case_uploads/" + employmentDetails[i].case.caseId + "/employment/" + employmentDetails[i]._id + "/proofofwork/")){ 
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + employmentDetails[i].case.caseId + "/employment/" + employmentDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 employmentChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + employmentDetails[i].case.caseId + "/employment/" + employmentDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              employmentParagraph.addChildElement(employmentChildParagraph)
		    
            }		    
            resolve(employmentParagraph)         
        })
    }    

    let getGlobaldatabaseCheck = function(globaldatabaseDetails){
        return new Promise((resolve,reject)=>{
            let globalDatabaseParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })		
	    if(globaldatabaseDetails == null){
	      resolve(globalDatabaseParagraph)	    
            }		    
            for(let i =0; i < globaldatabaseDetails.length;i++){	
             globalDatabaseChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Global Database Search",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:globaldatabaseDetails[i].grade == null ? "InProgress":getColorCodeName(globaldatabaseDetails[i].grade),
                                font :"Calibri",
                                color:globaldatabaseDetails[i].grade == null ? "000000":getColorCode(globaldatabaseDetails[i].grade),
                                bold:globaldatabaseDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Search Name",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:globaldatabaseDetails[i].searchnameRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Serious and Organized Crimes",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:globaldatabaseDetails[i].seriouscrimesRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Regulatory Authorities",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:globaldatabaseDetails[i].regulatoryRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Compliance Authorities",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:globaldatabaseDetails[i].complianceRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Search Date",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:globaldatabaseDetails[i].verificationCompletionDate,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },     
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                          
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Search Source",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:globaldatabaseDetails[i].sourceRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),

                        ]
                    })

                ]
               })  
//	      )	     
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + globaldatabaseDetails[i].case.caseId + "/globaldatabase/" + globaldatabaseDetails[i]._id + "/proofofwork/")){	    
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + globaldatabaseDetails[i].case.caseId + "/globaldatabase/" + globaldatabaseDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 globalDatabaseChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + globaldatabaseDetails[i].case.caseId + "/globaldatabase/" + globaldatabaseDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }  
          if(globaldatabaseDetails[i].case.subclient.client._id == "60619cc373e66249830623e9"){             
             if(fs.existsSync("/REPO_STORAGE/envestnet_db_check_template/")){
                let files = fs.readdirSync("/REPO_STORAGE/envestnet_db_check_template/")
                for(let j=0; j < files.length;j++){
                   if(path.extname(files[j]) != ".jpg"){
                     continue
                   }
                   globalDatabaseChildParagraph.addChildElement(new docx.Paragraph({
                      children:[
                      new docx.PageBreak(),
                      new docx.ImageRun({
                              data:fs.readFileSync("/REPO_STORAGE/envestnet_db_check_template/"+ files[j]),
                              transformation:{
                                      height:800,
                                      width:600
                              },
                      })
                     ]
                   }))
                }
              }
           }

              globalDatabaseParagraph.addChildElement(globalDatabaseChildParagraph)
		    
	    }	     
            resolve(globalDatabaseParagraph)         
        })
    }    
    let getIdentityCheck = function(identityDetails){
        return new Promise((resolve,reject)=>{
	    console.log("identity Details size is ",identityDetails.length)	
	    let identityParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })
	    if(identityDetails == null){
	      resolve(identityParagraph)	    
	    }	    
	    for(let i=0; i < identityDetails.length;i++){	
             identityChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Identity Check",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
//			alignment:docx.AignmentType.CENTER    
                        alignment:docx.AlignmentType.CENTER  
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:identityDetails[i].grade == null ? "InProgress":getColorCodeName(identityDetails[i].grade),
                                font :"Calibri",
                                color:identityDetails[i].grade == null ? "000000":getColorCode(identityDetails[i].grade),
                                bold:identityDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Type of Identity",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:identityDetails[i].typeofidRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name as per ID",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:identityDetails[i].nameasperidRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Issuing Authority",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:identityDetails[i].issuedbyRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"ID Number",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:identityDetails[i].idnumberRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified On",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:identityDetails[i].verifiedonRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },     
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                          
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:identityDetails[i].verifiedbyRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },     
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                          
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:identityDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),                            
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },     
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                          
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:identityDetails[i].gradeingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),                            

                        ]
                    })

                ]
              })  
//	     )
	     if (fs.existsSync("/REPO_STORAGE/case_uploads/" + identityDetails[i].case.caseId + "/identity/" + identityDetails[i]._id + "/proofofwork/")){
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + identityDetails[i].case.caseId + "/identity/" + identityDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 identityChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + identityDetails[i].case.caseId + "/identity/" + identityDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              identityParagraph.addChildElement(identityChildParagraph)


            }		    
            resolve(identityParagraph)         
        })
    }    

    let getReferenceBasicCheck = function(refBasicDetails){
        return new Promise((resolve,reject)=>{
	    let refBasicParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(refBasicDetails == null){
	      resolve(refBasicParagraph)	    
	    }	    
	    for(let i=0; i < refBasicDetails.length;i++){	
             refBasicChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Reference Verification",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:refBasicDetails[i].grade == null ? "InProgress":getColorCodeName(refBasicDetails[i].grade),
                                font :"Calibri",
                                color:refBasicDetails[i].grade == null ? "000000":getColorCode(refBasicDetails[i].grade),
                                bold:refBasicDetails[i].grade == null ? false:true
                            })
				
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of Referee and Designation",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].name + " , " + refBasicDetails[i].designation,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].nameRhs + " , " + refBasicDetails[i].designationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Contact Number & Email",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].contact,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].contactRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),

                        ]
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({

                            })                            
                        ]

                    }),
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Association With Subject",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].associationRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Time Referee Known to Candidate",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].timeRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Communication Skills",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].communcationRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Inter-Personal Skills",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].interpersonalRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Result Oriented",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].resultRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Attitude",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].attituteRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),


                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                              
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Reliability",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].reliabilityRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })
                                ]
                            }),


                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Strengths",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].strengthRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Weaknesses",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].weaknessRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Honesty",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].honesyRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Reliability",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].reliabilityRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Educational Credentials",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].educredentialsRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Employment Background",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].empbackgroundRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),                                                                                                                                                                                                                                                                                                                                                                            
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
         					        text:refBasicDetails[i].dateofverificationRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].nameRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:refBasicDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            })                                                                                    
                        ]
                    })

                ]
              })  
//	      )
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + refBasicDetails[i].case.caseId + "/refbasic/" + refBasicDetails[i]._id + "/proofofwork/")){
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + refBasicDetails[i].case.caseId + "/refbasic/" + refBasicDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 refBasicChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + refBasicDetails[i].case.caseId + "/refbasic/" + refBasicDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              refBasicParagraph.addChildElement(refBasicChildParagraph)
		  
            }		    
            resolve(refBasicParagraph)         
        })
    }    
    let getReferenceAdvancedCheck = function(referenceAdvancedDetails){
        return new Promise((resolve,reject)=>{
	    let referenceAdvancedParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })	
	    if(referenceAdvancedDetails == null){
	      resolve(referenceAdvancedParagraph)	    
	    }	    
	    for(let i=0; i < referenceAdvancedDetails.length;i++){	
             referenceAdvancedChildParagraph = new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Reference Verification",
                                font:"Calibri",
				size:25,
				bold:true    
                            }),
                        ],
			alignment:docx.AlignmentType.CENTER    
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri",
                            }),
		            new docx.TextRun({
                                text:referenceAdvancedDetails[i].grade == null ? "InProgress":getColorCodeName(referenceAdvancedDetails[i].grade),
				font :"Calibri",
                                color:referenceAdvancedDetails[i].grade == null ? "000000":getColorCode(referenceAdvancedDetails[i].grade),
                                bold:referenceAdvancedDetails[i].grade == null ? false:true
			    })		
                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),
			
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"COMPONENTS",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION PROVIDED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                            
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"INFORMATION VERIFIED",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                                alignment:docx.AlignmentType.CENTER                                                 

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Name of Referee and Designation",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].nameofreference + " , " + referenceAdvancedDetails[i].designation,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].nameofreferenceRhs + " , " + referenceAdvancedDetails[i].designationRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                        
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                    
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Contact Number & Email",
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].contactdetails,
                                                        font:"Calibri"
                                                    })          
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 3000,
                                            type: docx.WidthType.DXA,
                                        },                                               
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].contactdetailsRhs,
                                                        font:"Calibri"
                                                    })          
                                                ],

                                            })
                                        ]
                                    })                                                                        
                                ]
                            }),

                        ]
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({

                            })                            
                        ]

                    }),
                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Association With Subject",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].associationwithcandidateRhs,
                                                        font:"Calibri"
                                                    })
                                                ],

                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Time Referee Known to Candidate",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].timerefereceknownRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Communication Skills",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].communicationRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Inter-Personal Skills",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].interpersonalRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Result Oriented",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].resultRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Attitude",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].attitudeRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Strengths",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].strengthsRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Weaknesses",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].weaknessesRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Honesty",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].honestyRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Reliability",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].reliabilityRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Educational Credentials",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].educredentialsRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Employment Background",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].empbackgroundRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),                                                                                                                                                                                                                                                                                                                                                                            
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                        
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Date of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].dateofverificationRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].nameofreferenceRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })                                    
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },                                                                                                                                                                                                
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },                                                                                       
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:referenceAdvancedDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                                                        
                                ]
                            })                                                                                    
                        ]
                    })

                ]
              })  
//	      )
	      if (fs.existsSync("/REPO_STORAGE/case_uploads/" + referenceAdvancedDetails[i].case.caseId + "/reference/" + referenceAdvancedDetails[i]._id + "/proofofwork/")){	   
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + referenceAdvancedDetails[i].case.caseId + "/reference/" + referenceAdvancedDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 referenceAdvancedChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + referenceAdvancedDetails[i].case.caseId + "/reference/" + referenceAdvancedDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              referenceAdvancedParagraph.addChildElement(referenceAdvancedChildParagraph)
		    
	    }	    
            resolve(referenceAdvancedParagraph)         
        })
    }

    let getGapVfnCheck = function(gapVfnDetails){
        return new Promise((resolve,reject)=>{
            let gapVfnParagraph = new docx.Paragraph({
                children:[
                    new docx.TextRun("")
                ]
            })
            if(gapVfnDetails == null){
               resolve(gapVfnParagraph)
            }
            for(let i=0; i < gapVfnDetails.length;i++){
//             createJpgs("/REPO_STORAGE/case_uploads/"+ gapVfnDetails[i].case.caseId + "/gapvfn/" + gapVfnDetails[i]._id + "/proofofwork" )
               let gapVfnChildParagraph =  new docx.Paragraph({
                children:[
                    new  docx.PageBreak(),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                text :"Gap Check",
                                font:"Calibri",
                                size:25,
                                bold:true
                            }),
                        ],
                        alignment:docx.AlignmentType.CENTER
                    }),
                    new docx.Paragraph({
                        children:[
                            new docx.TextRun({
                                    text :"\t\t\t\t\t\t\t\t\tVerification Result: ",
                                font:"Calibri"
                            }),
                            new docx.TextRun({
                                text:gapVfnDetails[i].grade == null ? "InProgress":getColorCodeName(gapVfnDetails[i].grade),
                                font :"Calibri",
                                color:gapVfnDetails[i].grade == null ? "000000":getColorCode(gapVfnDetails[i].grade),
                                bold:gapVfnDetails[i].grade == null ? false:true
                            })

                        ]
                    }),
                    new docx.Paragraph({children:[new docx.TextRun("")]}),

                    new docx.Table({
                        rows:[
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"DETAILS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"FINDINGS",
                                                        font:"Calibri"
                                                    })
                                                ],
                                                alignment:docx.AlignmentType.CENTER
                                            })
                                        ]
                                    })
                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Gap Tenure",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:gapVfnDetails[i].tenureofgapRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),

                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Full Address during Gap",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:gapVfnDetails[i].addressRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Gap Reason",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:gapVfnDetails[i].reasonforgapRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),

                                ]
                            }),

                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:gapVfnDetails[i].verifiedbyRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),

                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Result",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:gapVfnDetails[i].resusltRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Verified By",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:gapVfnDetails[i].nameRhs,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })
                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Mode of Verification",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:gapVfnDetails[i].mode,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),

                                ]
                            }),
                            new docx.TableRow({
                                children:[
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        shading:{
                                            fill: "DCDCDC",
                                            type: docx.ShadingType.REVERSE_DIAGONAL_STRIPE,
                                            color: "auto",
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:"Remarks",
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    }),
                                    new docx.TableCell({
                                        width:{
                                            size: 4500,
                                            type: docx.WidthType.DXA,
                                        },
                                        children:[
                                            new docx.Paragraph({
                                                children:[
                                                    new docx.TextRun({
                                                        text:gapVfnDetails[i].gradingComments,
                                                        font:"Calibri"
                                                    })
                                                ],
                                            })
                                        ]
                                    })
                                ]
                            }),
                        ]
                    })

                ]

              })
              if (fs.existsSync("/REPO_STORAGE/case_uploads/" + gapVfnDetails[i].case.caseId + "/gapvfn/" + gapVfnDetails[i]._id + "/proofofwork/")){
               let  files = fs.readdirSync("/REPO_STORAGE/case_uploads/" + gapVfnDetails[i].case.caseId + "/gapvfn/" + gapVfnDetails[i]._id + "/proofofwork/")

               for(let j=0 ; j < files.length;j++){
                 if(path.extname(files[j]) != ".jpg"){
                   continue
                 }

                 gapVfnChildParagraph.addChildElement(new docx.Paragraph({
                    children:[
                         new docx.PageBreak(),
                         new docx.ImageRun({
                                 data:fs.readFileSync("/REPO_STORAGE/case_uploads/" + gapVfnDetails[i].case.caseId + "/gapvfn/" + gapVfnDetails[i]._id + "/proofofwork/" + files[j]),
                                 transformation:{
                                         height:600,
                                         width:600
                                 }

                         })
                    ]
                 }))
               }
              }
              gapVfnParagraph.addChildElement(gapVfnChildParagraph)
//           )
            }
            resolve(gapVfnParagraph)
        })
    }


    let getDisclaimer = function(){
	return new Promise((resolve,reject)=>{
           let disclaimerRootParagraph = new docx.Paragraph({
	       children:[new docx.TextRun("")]	   
	   })		
           let disclaimerHeaderParagraph = new docx.Paragraph({
                children:[,
	            new docx.PageBreak(),		
                    new docx.TextRun({
			    text:"Restrictions and Limitations",
			    font:"Calibri",
			    size:25,
			    bold:true,
			    underline:true
		    })
                ],
		alignment:docx.AlignmentType.CENTER   
            })
	    let blankLine =new docx.Paragraph({
		    children:[
		       new docx.TextRun("")	    
		    ]    
	    })	
	    let firstParagraph = new docx.Paragraph({
                children:[
	           new docx.TextRun({
		       text:"Our reports and comments are confidential in nature and are meant only for the internal use of the client to make an assessment of the background of the applicant. They are not intended for publication or circulation or sharing with any other person including the applicant. Also, they are not to be reproduced or used for any other purpose, in whole or in part, without our prior written consent in each specific instance",
		       font:"Calibri",
		       size:20	   
		   })		
		]	    
	    })
	    
	    let secondParagraph = new docx.Paragraph({
		    children:[
                      new  docx.TextRun({
                         text:"We request you to recognize that we are not the source of the data gathered and our findings are based on the information made available to us; therefore, we cannot guarantee the accuracy of the information collected. Should additional information or documentation become available to us, which impacts the conclusions reached in our reports, we reserve the right to amend our findings in our report accordingly. ",
			 font:"Calibri",
			 size:20     
		      }) 
		    ]    
	    })
	    let thirdParagraph = new docx.Paragraph({
		    children:[
		       new  docx.TextRun({
			  text:"We expressly disclaim all responsibility or liability for any costs, damages, losses, liabilities, expenses incurred by anyone as a result of circulation, publication, reproduction or use of our reports contrary to the provisions of this paragraph. You will appreciate that due to factors beyond our control, it may be possible that we are unable to get all the necessary information. Because of the limitations mentioned above, the results of our work with respect to the background checks should be considered only as a guide. Our reports and comments should not be considered as a definitive pronouncement on the individual.",
			 font:"Calibri",
			 size:20      

		       })	    
		    ]    
	    })
	    let footerParagraph = new docx.Paragraph({
		    children:[
		       new docx.TextRun({
			       text:"--END OF REPORT--",
			       font:"Calibri",
			       size:20,
			       bold:true
		       })	    
		    ],
		    alignment:docx.AlignmentType.CENTER
	    })	
	    disclaimerRootParagraph.addChildElement(disclaimerHeaderParagraph)
	    disclaimerRootParagraph.addChildElement(blankLine)	
            disclaimerRootParagraph.addChildElement(firstParagraph)
	    disclaimerRootParagraph.addChildElement(blankLine)
	    disclaimerRootParagraph.addChildElement(secondParagraph)	
	    disclaimerRootParagraph.addChildElement(blankLine)
            disclaimerRootParagraph.addChildElement(thirdParagraph)		
            disclaimerRootParagraph.addChildElement(blankLine)
	    disclaimerRootParagraph.addChildElement(footerParagraph)	
	   resolve(disclaimerRootParagraph)
		
	})
    }
    function getColorCodeName(colorCode){
	 console.log("In the function getcolorCodeName()")   
	 for(let i=0; i < colorMasterDetails.length;i++){
	    console.log("In color master ......checking for the colorCode sent " + colorCode)
            console.log("In color master.......colorMasterDetails code is " + colorMasterDetails[i].colorCode)		 
            if(colorMasterDetails[i]._id.toString() == colorCode.toString()){
	       return colorMasterDetails[i].name	    
            }		    
         }
	 return "In Progress"   
		
    }	    

    function getColorCode(colorCode){
        for(let i=0; i < colorMasterDetails.length;i++){
	   if(colorMasterDetails[i]._id.toString() == colorCode.toString()){
	       return colorMasterDetails[i].colorCode;	   
	   }	   
        }
	return "#FFFBBBAAA";    
    }	    
    	    
    
    createReport() 
    async function createReport(){
//	let execSumDet = new Array()   
	await getColorMaster()	
	let caseDetails = await getCaseDetails()
	let camEmailId = "defaultmail"    
	if(caseDetails.subclient.cam != null){
           camEmailId = await getCamEmailId(caseDetails.subclient.cam)
	}	
	let personalDetailsFromDb = await getPersonalDetailsFromDb(caseDetails._id)    
        let personalDetails  = await getPersonalDetails()
        let executiveSummaryDetails = await getExecutiveSummaryDetails()
        let clientNameTable = await getClientNametable(caseDetails.subclient.client.name)
        let blankLine = await getBlankLine()
        let reportTitleTable = await getReportTitleTable(caseDetails)
        let personalDetailsTable = await getPersonalDetailsTable(caseDetails,personalDetailsFromDb)
        let colorCodeTable = await getColorCodeTable()
	    
	    
/*        let executiveSummaryTable = await getExecutiveSummaryTable()
        executiveSummaryDetails.forEach(item=>{
            executiveSummaryTable.addChildElement(
                new docx.TableRow({
                    children:[ 
                        new docx.TableCell({
                            children:[new  docx.Paragraph(item.typeOfCheck)]
                        }),
                        new docx.TableCell({
                            children:[new  docx.Paragraph(item.briefDetails)]
                        }),
                        new docx.TableCell({
                            children:[new docx.Paragraph(item.status)]
                        })
                    ]
                })
            )
        })*/
// get check related data for the report
        let addressDetails = await getAddressDetails(caseDetails._id)
        let addressComprehensiveDetails = await getAddressComprehensiveDetails(caseDetails._id)
        let addressOnlineDetails = await getAddressOnlineDetails(caseDetails._id)
        let addressTelephoneDetails = await getAddressTelephoneDetails(caseDetails._id)
        let courtRecordDetails = await getCourtRecordDetails(caseDetails._id)
        let criminalRecordDetails = await getCriminalRecordDetails(caseDetails._id)
        let educationDetails = await getEducationDetails(caseDetails._id)
        let educationAdvancedDetails = await getEducationAdvancedDetails(caseDetails._id)
        let educationComprehensiveDetails = await getEducationComprehensiveDetails(caseDetails._id)
        let employmentDetails = await getEmploymentDetails(caseDetails._id)
        let empbasicDetails = await getEmpBasicDetails(caseDetails._id)
        let empadvanceDetails = await getEmpAdvanceDetails(caseDetails._id)
        let referenceRecordDetails = await getReferenceDetails(caseDetails._id)
        let refBasicDetails = await getRefBasicDetails(caseDetails._id)
        let identityDetails = await getIdentityDetails(caseDetails._id)
        let creditCheckDetails = await getCreditCheckDetails(caseDetails._id)
        let credittransDetails = await getCreditTransDetails(caseDetails._id)
        let creditEquifaxDetails = await getCreditEquifaxDetails(caseDetails._id)
        let globaldatabaseDetails = await getGlobaldatabaseDetails(caseDetails._id)
        let drugtestfiveDetails = await getDrugTestFiveDetails(caseDetails._id)
        let drugtestsixDetails = await getDrugTestSixDetails(caseDetails._id)
        let drugtestsevenDetails = await getDrugTestSevenDetails(caseDetails._id)
        let drugtesteightDetails = await getDrugTestEightDetails(caseDetails._id)
        let drugtestnineDetails = await getDrugTestNineDetails(caseDetails._id)
        let drugtesttenDetails = await getDrugTestTenDetails(caseDetails._id)
        let dlCheckDetails = await getDlCheckDetails(caseDetails._id)
        let directorshipCheckDetails = await getDirectorshipCheckDetails(caseDetails._id)
        let voterIdDetails = await getVoterIdDetails(caseDetails._id)
        let vddAdvanceDetails = await getVddAdvanceDetails(caseDetails._id)
        let bankStmtDetails = await getBankStmtDetails(caseDetails._id)
        let siteCheckDetails = await getSiteCheckDetails(caseDetails._id)
        let psychometricDetails = await getPsychometricDetails(caseDetails._id)
//        let socialmediaCheckDetails = await getSocialMediaDetails(caseDetails._id)
        let facisl3Details = await getFacisl3Details(caseDetails._id)
        let ofacDetails = await getOfacDetails(caseDetails._id)
        let gapvfnDetails = await getGapVfnDetails(caseDetails._id)
        let passportDetails = await getPassportDetails(caseDetails._id)
	await new Promise(resolve => setTimeout(resolve,50000))    
	console.log("All details  got")    
	 
	    

// use the data to create each section
	console.log("Criminal Check for the Word Report............size is ",criminalRecordDetails)
        let addressCheckSection = await getAddressCheck(addressDetails)
        let addressComprehensiveSection = await getAddressComprehensiveCheck(addressComprehensiveDetails)        
        let addressOnlineSection = await getAddressOnlineCheck(addressOnlineDetails)                
        let addressTelephoneSection = await getAddressTelephoneCheck(addressTelephoneDetails)                
        let courtRecordSection = await getCourtRecordCheck(courtRecordDetails)                
        let creditCheckSection = await getCreditCheck(creditCheckDetails)
        let creditCheckEquifaxSection = await getCreditEquifaxCheck(creditEquifaxDetails)
        let creditCheckTransunionSection = await getCreditCheckTransunion(credittransDetails)
        let criminalRecordCheckSection = await getCriminalRecordCheck(criminalRecordDetails)
        let directorshipcheckSection = await getDirectorshipCheck(directorshipCheckDetails)
        let dlCheckSection = await getDlCheck(dlCheckDetails)
        let drugTestEightPanelCheckSection = await getDrugTestEightPanelCheck(drugtesteightDetails)
        let drugTestFivePanelCheckSection = await getDrugTestFivePanelCheck(drugtestfiveDetails)
        let drugTestNinePanelCheckSection = await getDrugTestNinePanelCheck(drugtestnineDetails)        
        let drugTestSevenPanelCheckSection = await getDrugTestSevenPanelCheck(drugtestsevenDetails)        
        let drugTestSixPanelCheckSection = await getDrugTestSixPanelCheck(drugtestsixDetails)        
        let drugTestTenPanelCheckSection = await getDrugTestTenPanelCheck(drugtesttenDetails)                
        let educationCheckSection = await getEducationCheck(educationDetails)                
        let educationAdvancedCheckSection = await getEducationAdvancedCheck(educationAdvancedDetails)                        
        let educationComprehensiveCheckSection = await getEducationComprehensiveCheck(educationComprehensiveDetails)                        
        let employmentAdvancedCheckSection = await getEmploymentAdvancedCheck(empadvanceDetails)                                
        let employmentBasicCheckSection = await getEmploymentBasicCheck(empbasicDetails)                                
        let employmentComprehensiveCheckSection = await getEmploymentComprehensiveCheck(employmentDetails)                                        
        let globaldatabaseCheckSection = await getGlobaldatabaseCheck(globaldatabaseDetails)
        let identityCheckSection = await getIdentityCheck(identityDetails)
        let referenceBasicCheckSection = await getReferenceBasicCheck(refBasicDetails)
        let referenceAdvancedCheckSection = await getReferenceAdvancedCheck(referenceRecordDetails)
	let gapVfnCheckSection = await getGapVfnCheck(gapvfnDetails);    
	let disclaimerSection = await getDisclaimer()    

        let executiveSummaryTable = await getExecutiveSummaryTable()
        execSumDet.forEach(item=>{
            executiveSummaryTable.addChildElement(
                new docx.TableRow({
                    children:[
                        new docx.TableCell({
				children:[new  docx.Paragraph({children:[new docx.TextRun({text:item.checkName + " " + item.checkType,font:"Calibri"})]})]
                        }),
                        new docx.TableCell({
			     children:[new  docx.Paragraph({children:[new docx.TextRun({text:item.briefDetails,font:"Calibri"})]})]	
//                            children:[new  docx.Paragraph(item.briefDetails)]
                        }),
                        new docx.TableCell({
				children:[new  docx.Paragraph({children:[new docx.TextRun({text:(item.grade == null ? "In Progress":getColorCodeName(item.grade)),font:"Calibri",color:item.grade == null ? "000000":getColorCode(item.grade),bold:item.grade==null?false:true})]})]
//				children:[new docx.Paragraph(item.grade == null ? "In Progress":getColorCodeName(item.grade))]
                        })
                    ]
                })
            )
        })
	    
        console.log("Exec Sum Det in the word report has ",execSumDet)
// construct the document using the sections
        const doc  = new docx.Document({
            sections:[{
                propertis :{},
                headers:{
                    default: new docx.Header({
                        children:[
                            new docx.Paragraph({
                                children:[ new docx.ImageRun({
                                    data:fs.readFileSync('/REPO_STORAGE/verifacts_logo/verifacts-logo.png'),
                                    transformation:{
                                        width:150,
                                        height:100,
                                    },
    /*                                floating: {
                                        horizontalPosition: {
                                            offset: 1014400, // relative: HorizontalPositionRelativeFrom.PAGE by default
                                        },
                                        verticalPosition: {
                                            offset: 0, // relative: VerticalPositionRelativeFrom.PAGE by default
                                        },
                                    },*/                                
                                })],
                                alignment:docx.AlignmentType.CENTER
                            }),
/*			    new docx.Paragraph({
				    children:[
					new docx.TextRun({
					    text:"CONFIDENTIAL",
					    font:"Calibri"	
					})    
				    ]   
			    })*/	
                        ]
                    })
                },
		footers:{
                     default:new docx.Footer({
			         children:[
                                   new docx.Paragraph({
				     children:[
					new docx.TextRun({
					   text:"\t\t\t\t\t\t\t\t\tFor Verifacts Services Pvt. Ltd.",	
                                           font:"Calibri"
					})     
				     ] 	   
				   }),
                                   new docx.Paragraph({
				      children:[
					  new docx.TextRun({    
                                              text:"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t",
					      font:"Calibri"
					  }),
//					  if(camEmailId != null){    
					  new docx.ImageRun({
				              		  
						  data:fs.existsSync('/REPO_STORAGE/cam_signatures/'+ camEmailId + '.jpg')==true ? fs.readFileSync('/REPO_STORAGE/cam_signatures/'+ camEmailId + '.jpg'):fs.readFileSync('/REPO_STORAGE/cam_signatures/'+ 'defaultmail.jpg'),
                                                   transformation:{
                                                         width:100,
                                                        height:100,
                                                   },
                                                   floating: {
						      zIndex:5,	   
                                                      horizontalPosition: {
//                                                           relative: docx.HorizontalPositionRelativeFrom.RIGHT_MARGIN,
                                                           offset: 5540688,
							      
                                                      },
                                                      verticalPosition: {
//                                                           relative: docx.VerticalPositionRelativeFrom.BOTTOM_MARGIN,
                                                           offset: 9738360,
						      },
						     behindDocument:true		   
						  }	   
					  })
//					 }	  
					      
				      ]	   
				   }),
/*				   new docx.Paragraph({
		                      children:[   
                                        new docx.TextRun({
                                           text:"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tClient Account Manager",
                                           font:"Calibri"
                                        })
				      ]	      
				   }),	 */
                                   new docx.Paragraph({
                                     children:[
                                        new docx.TextRun({
                                            text:"CONFIDENTIAL",
                                            font:"Calibri"
                                        }),
                                        new docx.TextRun({
				            children: ["\t\t\t\t Page ",  docx.PageNumber.CURRENT , " of " , docx.PageNumber.TOTAL_PAGES,"\t\t\tClient Account Manager"],
					    font:"Calibri"
                                         }),
					     
                                     ]
                                  }),
		                ]    
		              })  
		},	
                children:[blankLine,clientNameTable,blankLine,reportTitleTable,blankLine,personalDetailsTable,blankLine,colorCodeTable,blankLine,executiveSummaryTable,addressCheckSection,addressComprehensiveSection,addressOnlineSection,addressTelephoneSection,courtRecordSection,criminalRecordCheckSection,educationAdvancedCheckSection,educationComprehensiveCheckSection,educationCheckSection,employmentAdvancedCheckSection,employmentBasicCheckSection,employmentComprehensiveCheckSection,referenceBasicCheckSection,referenceAdvancedCheckSection,identityCheckSection,creditCheckSection,creditCheckEquifaxSection,creditCheckTransunionSection,globaldatabaseCheckSection,drugTestEightPanelCheckSection,drugTestFivePanelCheckSection,drugTestNinePanelCheckSection,drugTestSevenPanelCheckSection,drugTestSixPanelCheckSection,drugTestTenPanelCheckSection,dlCheckSection,directorshipcheckSection,gapVfnCheckSection,disclaimerSection]
            },
        ]
            
        })        
        console.log("Created Doc")
        docx.Packer.toBuffer(doc).then(data=>{
            fs.writeFileSync(`/REPO_STORAGE/tmp/${caseDetails.caseId}.docx`,data)       
            allJpegs.forEach(item=>{
               console.log("Directory being searched for ",item)
               fs.readdirSync(item).forEach(file => {
                  if(path.extname(file) == ".jpg"){
                    console.log("About to delete JPEG file ",item + "/" + file)
                    fs.unlinkSync(item+"/"+file);
                  }
//                  console.log("File in the director ",file);
               });
            })

	    res.download(`/REPO_STORAGE/tmp/${caseDetails.caseId}.docx`,(err)=>{
		if(err){
	          res.status(500).send({
		      message:"Could not download  the file"	  
		  })      		
		}	
	    })
//	    res.download("")	
//            res.json({message:"Successful"})
//	  docx.Packer.toBlob(doc).then(data=>{
//	      res.json(data)

        })
        .catch(err=>{
            res.status(500).json({
                message:"Error"
            })
        })        
        
    }
    

      

    
}

